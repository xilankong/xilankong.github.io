---
layout: post
category: 2017å¹´
title : "fastlaneä½¿ç”¨è¯´æ˜ä¹¦"
---

> æ›´æ–°èŠ‚ç‚¹ï¼š2018-04-03
>
> ç”±äºfastlaneæ›´æ–°é¢‘ç¹ï¼Œå†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™æ˜¯ 2.53.1ï¼Œç°åœ¨æœ€æ–°ç‰ˆæœ¬æ˜¯2.89.0
>
> æ›´æ–°å†…å®¹ï¼šfastlaneæ–°å˜åŒ–ã€fastlaneæ–°é—®é¢˜ã€fastlaneé—ç•™é—®é¢˜è§£å†³



## fastlane ä»‹ç»

fastlaneæ˜¯ç”¨Rubyè¯­è¨€ç¼–å†™çš„ä¸€å¥—è‡ªåŠ¨åŒ–å·¥å…·é›†å’Œæ¡†æ¶ï¼Œæ¯ä¸€ä¸ªå·¥å…·å®é™…éƒ½å¯¹åº”ä¸€ä¸ªRubyè„šæœ¬ï¼Œç”¨æ¥æ‰§è¡ŒæŸä¸€ä¸ªç‰¹å®šçš„ä»»åŠ¡ï¼Œè€Œfastlaneæ ¸å¿ƒæ¡†æ¶åˆ™å…è®¸ä½¿ç”¨è€…é€šè¿‡ç±»ä¼¼é…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œå°†ä¸åŒçš„å·¥å…·æœ‰æœºè€Œçµæ´»çš„ç»“åˆåœ¨ä¸€èµ·ï¼Œä»è€Œå½¢æˆä¸€ä¸ªä¸ªå®Œæ•´çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚æ¯”å¦‚æˆ‘éœ€è¦å®Œæˆä¸€å¥—å‘å¸ƒæµç¨‹ï¼š

```
#å‘å¸ƒåˆ°AppStore

lane :release do
  #å¢åŠ buildç‰ˆæœ¬å·,éœ€è¦å…ˆé…ç½®build setting
  increment_build_number
  #podèµ„æºæ›´æ–°
  cocoapods
  #æ‰“åŒ…
  gym
  #å‘å¸ƒåˆ°AppStore
  deliver(force: true)
  #å‘å¸ƒtestflightæµ‹è¯•
  testflight
end
```



#### ä¾èµ–ç¯å¢ƒï¼š

- Xcode7 + ï¼ˆæœ¬æ–‡ï¼šxcode 9.3ï¼‰
- macOS or Linux with Ruby 2.0.0 + ï¼ˆæœ¬æ–‡ï¼šruby 2.3.1 ï¼‰



#### æœ¬æ–‡ç‰ˆæœ¬ï¼š

fastlaneç‰ˆæœ¬ï¼š~~2.53.1~~  å·²æ›´æ–°åˆ° 2.89.0

#### æ–‡æ¡£åœ°å€ï¼š

[Doc](https://docs.fastlane.tools)

#### å®‰è£…ï¼š

[sudo] gem install fastlane

```
å¦‚æœç”¨çš„æ˜¯macè‡ªå¸¦çš„rubyï¼Œéœ€è¦ sudoæƒé™
ä½¿ç”¨: sudo gem install fastlane

å¦‚æœæŠ¥é”™ï¼šERROR: While executing gem ... (Errno::EPERM) Operation not permitted - /usr/bin/commander 
ä½¿ç”¨: sudo gem install -n /usr/local/bin fastlane
```



#### åˆå§‹åŒ–ï¼š

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆå§‹åŒ–Fastlaneï¼š

```
fastlane init

æ–°ç‰ˆæœ¬å®‰è£…çš„æ—¶å€™å‡ºç°äº†ä¸‹é¢çš„åˆ†æ”¯é€‰æ‹©ï¼ŒæŒ‰è¦æ±‚é€‰æ‹©å°±è¡Œ

1. ğŸ“¸  Automate screenshots
2. ğŸ‘©â€âœˆï¸  Automate beta distribution to TestFlight (è‡ªåŠ¨testfilghtå‹é…ç½®)
3. ğŸš€  Automate App Store distribution (è‡ªåŠ¨å‘å¸ƒå‹é…ç½®)
4. ğŸ›   Manual setup - manually setup your project to automate your (éœ€è¦æ‰‹åŠ¨é…ç½®å†…å®¹)
```

fastlaneæ“ä½œæ”¹å˜åæˆ‘ä»¬å†äº†è§£ä¸€ä¸‹æœ‰å“ªäº›é…ç½®æ–‡ä»¶ï¼š

```
Appfile: å­˜å‚¨æœ‰å…³å¼€å‘è€…è´¦å·ç›¸å…³ä¿¡æ¯

Fastfile: æ ¸å¿ƒæ–‡ä»¶ï¼Œä¸»è¦ç”¨äº å‘½ä»¤è¡Œè°ƒç”¨å’Œå¤„ç†å…·ä½“çš„æµç¨‹ï¼Œlaneç›¸å¯¹äºä¸€ä¸ªæ–¹æ³•æˆ–è€…å‡½æ•°

Deliverfile: deliverå·¥å…·çš„é…ç½®æ–‡ä»¶
metadata: å…ƒæ•°æ®æ–‡ä»¶å¤¹

Matchfile: Matchæ“ä½œå¯¹åº”çš„é…ç½®æ–‡ä»¶

screenshots: æˆªå›¾æ–‡ä»¶å¤¹
```



é™¤å¼€æ‰‹åŠ¨é…ç½®é¡¹ï¼Œfastlane ä¼šè¦æ±‚å¡«å†™Apple IDï¼Œé€‰æ‹©ä½ çš„Team(å¦‚æœæœ‰å¤šä¸ª) ç„¶åfastlaneä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰ç›®å½•ä¸‹é¡¹ç›®çš„App Nameå’ŒApp Identifierã€Projectã€‚ç„¶åè‡ªè¡Œç¡®è®¤å¹¶æŒ‰æµç¨‹æ‰§è¡Œã€‚



#### å¸¸ç”¨å‘½ä»¤ï¼š

- fastlane actions: å±•ç¤ºæ‰€æœ‰æœ‰æ•ˆactionåˆ—è¡¨
- fastlane action [action_name]: å±•ç¤ºä¸€ä¸ªactionçš„è¯¦ç»†è¯´æ˜ï¼Œä½¿ç”¨æ–¹æ³•ç­‰
- fastlane lanes: å±•ç¤ºfastfileä¸­çš„æ‰€æœ‰lane
- fastlane list: å±•ç¤ºfastfileä¸­çš„æ‰€æœ‰çš„æœ‰æ•ˆçš„lane
- fastlane new_action: åˆ›å»ºä¸€ä¸ªæ–°çš„action
- fastlane env: æ‰“å°fastlaneã€rubyç¯å¢ƒï¼Œä¸€èˆ¬æbugåˆ°issueçš„æ—¶å€™ä¼šè¦æ±‚æä¾›



#### ç”Ÿå‘½å‘¨æœŸï¼š

| æ‰§è¡Œé¡ºåº | æ–¹æ³•å         | è¯´æ˜                     |
| ---- | ----------- | ---------------------- |
| 1    | before_all  | åœ¨æ‰§è¡Œ lane ä¹‹å‰åªæ‰§è¡Œä¸€æ¬¡       |
| 2    | before_each | æ¯æ¬¡æ‰§è¡Œ lane ä¹‹å‰éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡     |
| 3    | lane        | è‡ªå®šä¹‰çš„ä»»åŠ¡                 |
| 4    | after_each  | æ¯æ¬¡æ‰§è¡Œ lane ä¹‹åéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡     |
| 5    | after_all   | åœ¨æ‰§è¡Œ lane æˆåŠŸç»“æŸä¹‹åæ‰§è¡Œä¸€æ¬¡    |
| 6    | error       | åœ¨æ‰§è¡Œä¸Šè¿°æƒ…å†µä»»æ„ç¯å¢ƒæŠ¥é”™éƒ½ä¼šä¸­æ­¢å¹¶æ‰§è¡Œä¸€æ¬¡ |



#### å…¶ä»–ï¼š

1.å¦‚æœDeliverfileã€screenshotså’Œmetadataæ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆï¼Œé€šè¿‡deliver init å¯ä»¥é‡æ–°åˆå§‹åŒ–

2.fastlaneçš„é…ç½®ä¼šè¦æ±‚è¾“å…¥å¼€å‘è€…è´¦å·å¯†ç ï¼Œé€šè¿‡spaceshipä¸Appleäº¤äº’ï¼Œå¹¶ä¼šäº§ç”Ÿä¸€ä»½æœ‰æ•ˆæœŸä¸€ä¸ªæœˆçš„cookiesæ–‡ä»¶ï¼šæ–‡ä»¶åœ°å€ï¼š ~/.fastlane/spaceship/[email]/cookie ï¼ˆä¸¤æ­¥éªŒè¯é—®é¢˜ï¼‰

3.Matchfile: match è¿™ä¸ªactionçš„é…ç½®æ–‡ä»¶ï¼Œfastlane match init è‡ªåŠ¨ç”Ÿæˆï¼Œå­˜æ”¾gitåœ°å€ç­‰



## fastlane ä½¿ç”¨

### laneçš„ä½¿ç”¨

laneæ˜¯fastfileä¸­çš„æ–¹æ³•å®šä¹‰æ ‡ç­¾ï¼Œå¯ä»¥ç†è§£ä¸ºswiftä¸­å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå‰é¢çš„ funcã€‚fastlane éƒ½æ˜¯åŸºäºrubyï¼Œæ‰€ä»¥fastfileä¸­ä¹Ÿæ˜¯ä½¿ç”¨rubyè¯­æ³•çš„ã€‚

å®šä¹‰ä¸€ä¸ªç®€å•çš„æ— å‚lane

```
lane :package
	puts "è¿™æ˜¯ä¸€ä¸ªlane"
end
```

å®šä¹‰ä¸€ä¸ªå¸¦å‚çš„laneï¼Œåœ¨fastfileä¸­optionç±»ä¼¼äºä¸€ä¸ªå­—å…¸é›†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡  option[:configuration] å–å…¶ä¸­value

```
 lane :package do |option| 
    configuration = option[:configuration]
    puts configuration
 end
 
 //laneçš„è°ƒç”¨
 package(configuration: 'Release', export_method: 'ad-hoc')
```



### Action

é™¤å¼€æˆ‘ä»¬è‡ªå®šä¹‰fastfileä¸­çš„æ–¹æ³•ï¼Œfastlaneè¿˜æä¾›äº†å¾ˆå¤šå·²ç»å†™å¥½çš„ç‹¬ç«‹çš„æ–¹æ³•åº“ï¼Œä¹Ÿå°±æ˜¯Actionsã€‚

Actionæ˜¯Fastlaneè‡ªåŠ¨åŒ–æµç¨‹ä¸­çš„æœ€å°æ‰§è¡Œå•å…ƒï¼Œç›´è§‚ä¸Šæ¥è®²å°±æ˜¯Fastfileè„šæœ¬ä¸­çš„ä¸€ä¸ªä¸ªå‘½ä»¤ï¼Œè€Œè¿™äº›å‘½ä»¤èƒŒåéƒ½å¯¹åº”ä¸€ä¸ªç”¨Rubyç¼–å†™çš„è„šæœ¬ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒFastlaneçš„å·¥å…·é›†å¤§çº¦åŒ…å«180å¤šä¸ªActionï¼ŒåŸºæœ¬ä¸Šæ¶µç›–äº†æ‰“åŒ…ï¼Œç­¾åï¼Œæµ‹è¯•ï¼Œéƒ¨ç½²ï¼Œå‘å¸ƒï¼Œåº“ç®¡ç†ç­‰ç­‰ç§»åŠ¨å¼€å‘ä¸­æ¶‰åŠåˆ°çš„å†…å®¹ã€‚

```
fastlane actions : æŸ¥çœ‹actionåˆ—è¡¨

fastlane action  action_nameï¼šæŸ¥çœ‹å…·ä½“action æè¿°
```

#### å¸¸ç”¨Action

Actionåˆ—è¡¨æ–‡æ¡£: [Actions](https://docs.fastlane.tools/actions/)

æˆ‘ä»¬å¸¸ç”¨çš„ä¸»è¦åŒ…æ‹¬ä¸‹é¢å‡ éƒ¨åˆ†ï¼Œå…¶ä»–actionçš„ä½¿ç”¨å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£:

- [scan](https://github.com/fastlane/fastlane/tree/master/scan) => è‡ªåŠ¨è¿è¡Œæµ‹è¯•å·¥å…·ï¼Œå¹¶ä¸”å¯ä»¥ç”Ÿæˆæ¼‚äº®çš„HTMLæŠ¥å‘Š
- [match](https://github.com/fastlane/fastlane/tree/master/match) => ä¸€ä¸ªæ–°çš„è¯ä¹¦å’Œé…ç½®æ–‡ä»¶ç®¡ç†å·¥å…·ã€‚æŠŠæ‰€æœ‰éœ€è¦ç”¨åˆ°çš„è¯ä¹¦ä¼ åˆ°gitç§æœ‰åº“ä¸Šï¼Œä»»ä½•éœ€è¦é…ç½®çš„æœºå™¨ç›´æ¥ç”¨matchåŒæ­¥å›æ¥å°±ä¸ç”¨ç®¡è¯ä¹¦é—®é¢˜äº†
- [gym](https://github.com/fastlane/fastlane/tree/master/gym) => Fastlaneå®¶æ—çš„è‡ªåŠ¨åŒ–ç¼–è¯‘å·¥å…·ï¼Œå’Œå…¶ä»–å·¥å…·é…åˆçš„éå¸¸é»˜å¥‘
- [deliver](https://github.com/fastlane/fastlane/tree/master/deliver) => è‡ªåŠ¨ä¸Šä¼ æˆªå›¾ï¼ŒAPPçš„å…ƒæ•°æ®ï¼ŒäºŒè¿›åˆ¶(ipa)æ–‡ä»¶åˆ°iTunes Connect
- [pilot](https://github.com/fastlane/fastlane/tree/master/pilot) => ç®¡ç†TestFlightçš„æµ‹è¯•ç”¨æˆ·ï¼Œä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶
- [spaceship](https://github.com/fastlane/fastlane/tree/master/spaceship) => ä¸ºpilotï¼Œboardingå’Œdeliverç­‰å·¥å…·æä¾›å’Œ iTC å’Œ ADC çš„äº¤äº’APIã€‚spaceshipæœ¬æ¥æ˜¯ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œåæ¥è¢«Fastlaneæ”¶ç¼–è¿›æ¥ [éå®˜æ–¹çš„iTunes Connect JSON APIçš„æ–‡æ¡£](https://github.com/fastlane/itc-api-docs)  

#### å¸¸ç”¨Actionä½¿ç”¨

scan

```
releaseæƒ…å†µä¸‹æ— æ³•æ­£å¸¸è¿è¡Œscanï¼Œéœ€è¦æ‰‹åŠ¨å»Build Settingä¸­æ›´æ”¹enable Testability åœ¨release ä¸‹çš„çŠ¶æ€ï¼Œæ”¹ä¸º yesæ‰å¯ä»¥è¿è¡Œã€‚ä½†æ˜¯å®˜æ–¹ä¸å»ºè®®åšreleaseä¸‹å¼€å¯ï¼ŒTestä¸€èˆ¬åœ¨development configuration ä¸‹æ‰§è¡Œã€‚
```

match

```
ä¸€ä¸ªæ–°çš„è¯ä¹¦å’Œé…ç½®æ–‡ä»¶ç®¡ç†å·¥å…·ã€‚å®ƒä¼šæŠŠæ‰€æœ‰éœ€è¦ç”¨åˆ°çš„è¯ä¹¦ä¼ åˆ°gitç§æœ‰åº“ä¸Šï¼Œä»»ä½•éœ€è¦é…ç½®çš„æœºå™¨ç›´æ¥ç”¨matchåŒæ­¥å›æ¥å°±ä¸ç”¨ç®¡è¯ä¹¦é—®é¢˜äº†ã€‚ä¿è¯å¤§å®¶ç”¨çš„éƒ½æ˜¯åŒä¸€ä»½ã€‚ä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä¸€å°æœºå™¨éœ€è¦ç”¨åˆ°distributionè¯ä¹¦ï¼Œæ‰€ä»¥æ„ä¹‰ä¸å¤§ã€‚

1.matchåªè®¤è¯†é€šè¿‡matchæ–¹å¼åˆ›å»ºçš„ppæ–‡ä»¶ è¯ä¹¦ï¼Œå…¶ä»–æ–¹å¼åˆ›å»ºçš„ä¸äºˆç†ä¼šã€‚
2.ä½¿ç”¨match éœ€è¦å…ˆæ’¤é”€ç°åœ¨çš„è¯ä¹¦ã€‚
3.å¦‚æœè‹¹æœç«¯çš„è¯ä¹¦,ppæ–‡ä»¶å·²åˆ é™¤ï¼Œé‚£ä¹ˆè¿œç«¯gitä¸Šçš„æ–‡ä»¶ä¹Ÿä¼šå¤±æ•ˆï¼Œå¹¶ä¸”åœ¨é‡æ–°matchçš„æ—¶å€™ä¼šå¤±è´¥,å¥½åƒå°±åªèƒ½åˆ å…‰ gitç«¯å†…å®¹ï¼Œé‡æ–°matchä¸€éã€‚

å¸¸ç”¨å‚æ•°ï¼š
git_url ï¼š æŒ‡å®šå¯¹åº”gitåœ°å€
git_branch ï¼š æŒ‡å®šå¯¹åº”branch
type ï¼šè¯·æ±‚æ–‡ä»¶ç±»å‹, appstore, adhoc, development, enterprise
app_identifier ï¼š app_bundle_identify
clone_branch_directly : åªæ›´æ–°å¯¹åº”branchï¼Œåªæœ‰åœ¨å­˜åœ¨è¿™ä¸ªbranchæ—¶æ‰ç”Ÿæ•ˆ
force_for_new_devices : å¦‚æœè®¾å¤‡devicesåˆ—è¡¨æ›´æ–°äº†ï¼Œå°±å¼ºåˆ¶æ›´æ–°é…ç½®æ¦‚è¦æ–‡ä»¶
verbose ï¼šæ‰“å°å‡ºé¢å¤–çš„ä¿¡æ¯å’Œæ‰€æœ‰çš„å‘½ä»¤
```

gym

```
å¸¸ç”¨å‚æ•°ï¼š
scheme ï¼šæŒ‡å®šæ‰“çš„å“ªä¸ªscheme
project ï¼šæŒ‡å®šproject (æœªä½¿ç”¨cocopods)
workspace ï¼šæŒ‡å®šworkspace (ä½¿ç”¨cocopods)
clean ï¼šæ‰“åŒ…å‰clean
xcargs ï¼š é™„åŠ ä¸€äº›å‚æ•°ä¼ é€’ç»™xcodebuild å¦‚ï¼š xcargs: 'DEBUG_INFORMATION_FORMAT="dwarf-with-dsym"',
export_method ï¼šå‡ºåŒ…æ–¹æ³• app-store, ad-hoc, package, enterprise, development
configuration ï¼š æŒ‡å®šæ„å»ºAppçš„é…ç½®  Releaseã€Debugã€è‡ªå®šä¹‰
output_directory ï¼š è¾“å‡ºç›®å½•
output_name ï¼šè¾“å‡ºåç§°
include_symbols ï¼šæ˜¯å¦åŒ…å«è°ƒè¯•ç¬¦å·
include_bitcode ï¼šæ˜¯å¦å¼€å¯bitcode

çº¯swiftå·¥ç¨‹æ‰“åŒ…ï¼Œåœ¨éappstoreè¯ä¹¦ä¸‹ç­¾å‡ºæ¥çš„åŒ…éƒ½ç¼ºå°‘ä¸€ä¸ªswiftsupportæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾çš„æ˜¯swiftçš„æ”¯æŒåº“ã€‚
```

deliver

```
ç”¨äºç›´æ¥å‘åŒ…åˆ°appstoreï¼Œå¯ä»¥é€‰æ‹©è·³è¿‡å›¾ç‰‡å’Œå…ƒæ•°æ®ä¸Šä¼ ï¼ŒåªæåŒ…ï¼Œåé¢å†é…å›¾å’Œæ•°æ®ï¼šå¦‚ä¸‹ skip_screenshots å’Œ  skip_metadata å‚æ•°
 deliver(
    ipa: "#{OUTPUT_DIRECTORY}" + "/" + "#{IPA_NAME}",
    skip_screenshots: true,
    skip_metadata: true
)
```

pilot

```
ç”¨äºå‘å¸ƒtestflightå†…éƒ¨æµ‹è¯•ï¼Œå±äºtestflight actionçš„åˆ«å

å¸¸ç”¨å‚æ•°:
ipa ï¼šè¦æäº¤çš„åŒ…åœ°å€
team_nameã€team_id ï¼šå¦‚æœæœ‰å¤šä¸ªteam ç”¨äºåŒºåˆ†team
skip_waiting_for_build_processing ï¼š åœ¨æäº¤å®Œæˆåçš„ç­‰å¾…æ˜¯å¦è·³è¿‡ï¼Œä¸€èˆ¬è·³è¿‡
changelog
testflight(
  ipa : '../xx.ipa'
)
```

spaceship [[å¸¸è§é—®é¢˜å®˜æ–¹è§£é‡Š](https://docs.fastlane.tools/best-practices/continuous-integration/#two-step-or-two-factor-auth)]

```
spaceshipå…¶å®ä¸€èˆ¬fastfileä¸­ä¸ä¼šä½¿ç”¨åˆ°ï¼Œä½†æ˜¯ç”±äºæ¶‰åŠåˆ°ä¸ADCçš„é€šä¿¡ï¼Œä¼šå‡ºç°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œæ‰€ä»¥å¯¹å®ƒä¹Ÿè¦æœ‰ä¸€ç‚¹äº†è§£ã€‚

å½“ç¬¬ä¸€æ¬¡ä½¿ç”¨fastlaneå®‰è£…çš„æ—¶å€™ï¼Œä¼šè¦æ±‚è¾“å…¥è´¦å·å¯†ç æ ¸å®ä½ çš„èº«ä»½æ¥è¿æ¥ADCï¼Œè¿™ä¸ªæ—¶å€™ä½ æä¾›çš„ç™»å½•éªŒè¯ä¼šå¤„ç†ä¸ºä¼šè¯å­˜åˆ° spaceship çš„ cookieï¼Œä¼šè¯å¤§æ¦‚ä¸€ä¸ªæœˆæœ‰æ•ˆæœŸï¼Œä¸€ä¸ªæœˆåå¤±æ•ˆï¼Œé€šå¸¸æˆ‘ä»¬åªæœ‰åœ¨æ‰“åŒ…å¤±è´¥åæ‰ä¼šå‘ç°è¿™ä¸ªé—®é¢˜ã€‚
```



ä¸Šé¢æåˆ°çš„è¿™äº›actionéƒ½æ˜¯å¸¸ç”¨çš„ï¼Œæ­£å¸¸æ‰“åŒ…æµç¨‹å¿…ä¸å¯å°‘çš„éƒ¨åˆ†ï¼Œè¿˜æœ‰ä¸€äº›å¸¸ç”¨äºè¾…åŠ©ä½œç”¨çš„Action

- resign  ï¼šé‡æ–°ç­¾å

  ```
  fastlane sigh resign dev.ipa --signing_identity "è¯ä¹¦ID" -p â€œdev.mobileprovision"
  ```

- get_info_plist_value  ï¼šè·å–info.plistä¸­å¾—æŸä¸ªkeyçš„å€¼

- set_info_plist_value  ï¼šè®¾ç½®info.plistä¸­å¾—æŸä¸ªkeyçš„å€¼

- increment_build_number  ï¼šè‡ªåŠ¨é€’å¢é¡¹ç›®buildå·

- increment_version_number  ï¼šè‡ªåŠ¨é€’å¢é¡¹ç›®ç‰ˆæœ¬å·

- get_version_numberï¼š è·å–ç‰ˆæœ¬å·ï¼ˆæ–°fastlaneç‰ˆæœ¬ä¸èƒ½å†æ·»åŠ schemeå‚æ•°ï¼Œåªéœ€è¦targetå³å¯ï¼‰

ä»¥ä¸Šä¸¤ä¸ªéƒ½éœ€è¦å…ˆé…ç½®å¥½xcode, [é…ç½®æ–‡æ¡£](https://developer.apple.com/library/content/qa/qa1827/_index.html)


### è‡ªå®šä¹‰Action

ç”±äºå¼€å‘éœ€æ±‚å„è‡ªä¸åŒï¼Œå·²æœ‰çš„actionä¸æ»¡è¶³çš„æƒ…å†µä¸‹ï¼ŒFastlaneæ”¯æŒå®šä¹‰è‡ªå·±çš„Actionã€‚Fastlaneä¸ºæˆ‘ä»¬æä¾›äº†ç°æˆçš„æ¨¡æ¿ï¼Œå³ä½¿ä½ å¯¹Rubyçš„è¯­æ³•ä¸ç†Ÿæ‚‰ï¼Œä¹Ÿæ²¡æœ‰å…³ç³»ï¼ŒFastlaneæ˜¯å¼€æºçš„å˜›ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½æºç çœ‹çœ‹åˆ«äººçš„Actionæ˜¯æ€ä¹ˆå†™çš„å°±çŸ¥é“äº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰¾åˆ°æ‰€æœ‰çš„Actionæ–‡ä»¶ï¼š

[Action_rbs](https://github.com/fastlane/fastlane/tree/master/fastlane/lib/fastlane/actions)

å‡è®¾ï¼Œæˆ‘ä»¬é’ˆå¯¹podçš„æ‰§è¡Œåˆ›å»ºä¸€ä¸ªactionæ¥é’ˆå¯¹ä¸‹é¢ä¸‰ç§æƒ…å†µçš„æ‰§è¡Œ

```
pod install --no-repo-update (é¿å…master repoçš„æ¯æ¬¡æ›´æ–°è€—æ—¶)
pod update --no-repo-update (é¿å…master repoçš„æ¯æ¬¡æ›´æ–°è€—æ—¶)
pod repo update XXX (ç§æœ‰repoçš„æ›´æ–°)
```

è‡ªå®šä¹‰Actionçš„æµç¨‹å¤§çº¦å¦‚ä¸‹ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤ï¼š

```
fastlane new_action
```

ç„¶åæ ¹æ®æç¤ºï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ•²å…¥actionçš„åå­—podï¼Œç„¶åFastlaneä¼šåœ¨å½“å‰ç›®å½•çš„actionsæ–‡ä»¶å¤¹ä¸­å¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªpod.rbçš„Rubyæ–‡ä»¶ ï¼ˆæ­¤å¤„åªæœ‰éƒ¨åˆ†ä»£ç ï¼‰

```
module Fastlane
  module Actions
    module SharedValues
      POD_CUSTOM_VALUE = :POD_CUSTOM_VALUE
    end
    class PodAction < Action
      def self.run(params)
        UI.message "Parameter API Token: #{params[:api_token]}"
      end
      ......
      def self.available_options
        # Define all options your action supports. 
      end
      ......
```

å¯ä»¥çœ‹åˆ°ï¼Œè‡ªå®šä¹‰çš„Actionéƒ½æ˜¯éš¶å±äºFastlane/Actionsè¿™ä¸ªmoduleï¼Œå¹¶ä¸”ç»§æ‰¿è‡ªActionè¿™ä¸ªçˆ¶ç±»ã€‚è™½ç„¶æ¨¡æ¿ä¸­çš„å†…å®¹è¿˜æŒºå¤šï¼Œä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œå¤§éƒ¨åˆ†å†…å®¹éƒ½æ˜¯ä¸€äº›ç®€å•çš„æ–‡æœ¬æè¿°ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´åªéœ€è¦é‡ç‚¹å…³æ³¨è¿™ä¸¤ä¸ªæ–¹æ³•å°±è¡Œï¼š

1. self.runæ–¹æ³•ï¼šè¿™é‡Œæ”¾ç½®çš„æ˜¯å®é™…çš„ä¸šåŠ¡å¤„ç†ä»£ç ã€‚
2. self.available_optionsæ–¹æ³•ï¼šè¿™é‡Œå£°æ˜éœ€è¦å¯¹å¤–æš´éœ²å‡ºçš„å‚æ•°ï¼Œæ²¡æœ‰å£°æ˜çš„å‚æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ— æ³•ä½¿ç”¨ã€‚

æœ€ç»ˆå†™å®Œç»“æœå¦‚ä¸‹ï¼š

```
module Fastlane
  module Actions
    module SharedValues
      POD_INSTALL_CUSTOM_VALUE = :POD_INSTALL_CUSTOM_VALUE
    end
    class PodInstallAction < Action
      def self.run(params)
        repo = "-no-repo-update"
        command = []
        command << "pod install"
        if params[:repo_update]
          repo = "--repo-update"
        end
        command << repo
        if params[:verbose]
          command << "--verbose"
        end
        result = Actions.sh(command.join(' '))
        UI.success(command.join(' ') + " Successfully ")
        return result
      end

      def self.description
        "pod install action"
      end
      def self.details
        "verbose / repo-update"
      end
      def self.available_options
        [
        FastlaneCore::ConfigItem.new(key: :verbose,
                                       description: "Allow output detail in console",
                                       optional: true,
                                       is_string: false,
                                       default_value: false),
          FastlaneCore::ConfigItem.new(key: :repo_update,
                                       description: "Allow output detail in console",
                                       optional: true,
                                       is_string: false,
                                       default_value: false)
        ]
      end
      def self.output
      end
      def self.return_value
      end
      def self.authors
        ["yang"]
      end
      def self.is_supported?(platform)
        platform == :ios
      end
    end
  end
end
```

Actionå¼•ç”¨æœºåˆ¶

è¿œç¨‹å¼•ç”¨

```
# è¿œç¨‹Gitå¼•ç”¨ï¼š
import_from_git(url: 'https://github.com/xilankong/ruby', branch: 'master')
# å¤å†™å‘å¸ƒé¡¹ç›®çš„lane
lane :do_deliver_app do |options|
  # ...
end
```

æœ¬åœ°å¼•ç”¨

```
import "../GeneralFastfile"
actions_path '../custom_actions_folder/'
lane :appstore do |options|
  # ...
end
```



### Plugin

æˆ‘ä»¬åœ¨ä½¿ç”¨Fastlaneçš„æ—¶å€™å¸¸å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼š

1. æˆ‘çš„è‡ªå®šä¹‰Actionéœ€è¦åœ¨å¤šä¸ªå†…éƒ¨é¡¹ç›®ä¸­ä½¿ç”¨
2. æˆ‘è§‰å¾—è¿™ä¸ªè‡ªå®šä¹‰Actionå¾ˆä¸é”™ï¼Œæƒ³å…±äº«ç»™å…¶ä»–çš„å›¢é˜Ÿä½¿ç”¨

æ­¤æ—¶ï¼Œæ‹·è´ç²˜è´´è™½ç„¶å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†å¹¶ä¸æ˜¯ä¸€ä¸ªèªæ˜çš„æ–¹æ¡ˆã€‚å°†Actionå‘å¸ƒåˆ°Fastlaneçš„å®˜æ–¹ä»“åº“å€’æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†æ˜¯å®˜æ–¹ä»“åº“æœ¬èº«å¯¹Actionçš„è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸ä¼šæ¥æ”¶éé€šç”¨æ€§çš„Actionï¼Œå³ä½¿æ¥æ”¶äº†ï¼Œæ•´ä¸ªå‘å¸ƒå‘¨æœŸä¹Ÿä¼šæ¯”è¾ƒé•¿ï¼Œè€Œä¸”ä»¥åæ— è®ºæ˜¯å‡çº§è¿˜æ˜¯Bugä¿®å¤ï¼Œéƒ½ä¾èµ–Fastlaneæœ¬èº«çš„å‘ç‰ˆï¼Œå¤§å¤§é™ä½äº†çµæ´»æ€§ã€‚

æ‰€ä»¥ä»1.93å¼€å§‹ï¼ŒFastlaneæä¾›äº†ä¸€ç§Pluginçš„æœºåˆ¶æ¥è§£å†³è¿™ç§é—®é¢˜ã€‚å¤§å®¶å¯ä»¥ç†è§£ä¸ºï¼šPluginå°±æ˜¯åœ¨Actionçš„åŸºç¡€ä¸Šåšäº†ä¸€å±‚åŒ…è£…ï¼Œè¿™ä¸ªåŒ…è£…å·§å¦™çš„åˆ©ç”¨äº†RubyGemsè¿™ä¸ªç›¸å½“æˆç†Ÿçš„Rubyåº“ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥å…¶å¯ä»¥ç‹¬ç«‹äºFastlaneä¸»ä»“åº“è¿›è¡ŒæŸ¥æ‰¾ï¼Œå®‰è£…ï¼Œå‘å¸ƒå’Œåˆ é™¤ã€‚

æˆ‘ä»¬ç”šè‡³å¯ä»¥ç®€å•çš„è®¤ä¸ºï¼šPluginå°±æ˜¯RubyGemå°è£…çš„Actionï¼Œæˆ‘ä»¬å¯ä»¥åƒç®¡ç†RubyGemsä¸€æ ·æ¥ç®¡ç†Fastlaneçš„Pluginã€‚

ä½†æ˜¯ï¼Œå¦‚æœä¸ºäº†å¤šé¡¹ç›®å…±äº«ä»»åŠ¡ï¼Œæˆ–è€…å…±äº«fastfileï¼Œå¯ä»¥é€šè¿‡Actionçš„è¿œç¨‹å¼•ç”¨æœºåˆ¶ã€‚æ‰€ä»¥Pluginä¸è¿‡å¤šä»‹ç»ã€‚



### æŒç»­åŒ–æ‰“åŒ…è¿˜éœ€è¦çš„Action

1.monkey

2.ftp æäº¤è¿œç¨‹æœåŠ¡å™¨ ï¼ˆå·²è§£å†³ï¼‰

3.æµ‹è¯•æ—¥å¿—è§£æ

4.jiraæäº¤bug

5.è‡ªåŠ¨æ‰“framework ï¼ˆå·²è§£å†³ï¼‰



## å¸¸è§é—®é¢˜

#### 1ã€Fastlaneå®‰è£…é—®é¢˜

å®‰è£…Fastlane(å½“å‰ç‰ˆæœ¬ï¼šruby- 2.3.1ã€fastlane 2.45.0)

```
rvmå®‰è£… 
curl -L get.rvm.io | bash -s stable  
å®‰è£…æˆåŠŸåã€å¯ç”¨rvm
source ~/.bashrc  
source ~/.bash_profile  
æµ‹è¯•å®‰è£…ç»“æœ
rvm -v
å‡çº§ruby
rvm install 2.3.1
æŸ¥çœ‹å®‰è£…çš„æ‰€æœ‰ruby
rvm list
åˆ‡æ¢ruby
rvm use 2.3.1 
è®¾ç½®rvmé»˜è®¤ç‰ˆæœ¬
rvm --default 2.3.1

fastlane å®‰è£…ï¼š
sudo gem install -n /usr/local/bin fastlane
```




#### 2ã€rubyç‰ˆæœ¬å¿…é¡»é«˜äº2.0ï¼Œæµ‹è¯•æœ¬æœº2.0ä¹Ÿæ— æ•ˆï¼Œæ‰€ä»¥æœ€å¥½2.0+

å¦‚æœæœ‰é—®é¢˜ã€å¸è½½é‡è£…



#### 3ã€Jenkins ç¯å¢ƒ RVMæœªæ¿€æ´»é—®é¢˜

jenkinsä¸­è·å–ä¸åˆ°åœ¨ç›®æ ‡æœåŠ¡å™¨å®‰è£…çš„æœ€æ–°RVM å’Œ rubyã€fastlane

è§£å†³æ–¹æ¡ˆ :

~/.bashrc ã€~/.zshrc  ã€~/.zlogin å†…å®¹

```
PATH=$PATH:$HOME/.rvm/bin
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM 
```

åœ¨jenkinsæ‰§è¡Œè„šæœ¬å†… å¯ç”¨RVMï¼š

```
source $HOME/.rvm/scripts/rvm
```



#### 4ã€å…³äºå¼€å¯ä¸¤æ­¥éªŒè¯å¦‚ä½•å…¨è‡ªåŠ¨åŒ–é—®é¢˜

å¼€å¯ä¸¤æ­¥éªŒè¯åï¼Œæäº¤testfilghtæˆ–è€…appstoreä¼šå‡ºç°å¦‚ä¸‹æç¤ºï¼Œè¦æ±‚æ‰‹åŠ¨ç¡®è®¤å¹¶ è¾“å…¥6ä½code

```
Two Factor Authentication for account 'xxxxx@xx.com' is enabled
If you're running this in a non-interactive session (e.g. server or CI)
check out https://github.com/fastlane/fastlane/tree/master/spaceship#2-step-verification
Please enter the 6 digit code:
```

è¿™æ ·æ˜æ˜¾å½±å“å…¨è‡ªåŠ¨åŒ–æäº¤æ“ä½œã€‚

è§£å†³æ–¹æ¡ˆï¼š

fastlaneæä¾›çš„ä¸¤æ­¥éªŒè¯è§£å†³æ–¹æ¡ˆï¼š

```
1.è®¿é—® https://appleid.apple.com/account/manage 
2.ç”Ÿæˆä¸€ä¸ª APP-SPECIFIC PASSWORDSï¼Œä¿ç•™ç”Ÿæˆçš„ç‰¹æ®Šå¯†ç 
3.ä½¿ç”¨ç¯å¢ƒå˜é‡æä¾›è¿™ä¸ªå¯†ç ç»™fastlaneï¼š  FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD
4.æ‰§è¡Œfastlane spaceauth -u user@email.comï¼Œç”Ÿæˆsession cookieã€‚
5.é€šè¿‡ç¯å¢ƒå˜é‡FASTLANE_SESSION æä¾›session cookiesã€‚

é…ç½®åœ°æ–¹ï¼š

æ‰“åŒ…æœºï¼š~/.bash_profile ä¸­ï¼Œé…ç½® FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD å’Œ FASTLANE_SESSION

ä¾‹å¦‚ï¼š
export FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD=ç‰¹æ®Šå¯†ç 
export FASTLANE_SESSION=session cookie

æœ¬æœºä½¿ç”¨çš„æ˜¯Item2 /bin/zsh æ‰€ä»¥é…ç½®åœ¨ ~/.bash_profile
Jenkinsï¼šé…ç½®å¯¹åº”ç¯å¢ƒå˜é‡å³å¯

è¿˜æœ‰ä¸€ä¸ªå°ä¼™ä¼´å‘ŠçŸ¥å¦ä¸€ä¸ªé…ç½®æ–¹å¼
ENV["FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD"] = "xxxxxx"
è¿™ä¸ªå’Œç¯å¢ƒå˜é‡é…ç½®æ˜¯ä¸€ä¸ªæ„æ€ï¼Œä½†æ˜¯æ¶‰åŠå¯†ç å†™åœ¨é…ç½®æ–‡ä»¶é‡Œé¢

ä½†æ˜¯ï¼Œæœ¬æ–‡æµ‹è¯•ä¸€ä¸ªæœˆåå‘ç°ä¾ç„¶å¤±æ•ˆï¼Œæœ€åé€‰æ‹©çš„æ–¹æ¡ˆæ˜¯å¼€è®¾ä¸€ä¸ªæœªå¼€å¯ä¸¤æ­¥éªŒè¯çš„è´¦å·ä½œä¸ºå¼€å‘è´¦å·çš„å­è´¦å·ä¸“é—¨ç”¨æ¥æ‰“åŒ…ã€‚
å¦‚æœ‰ä¸è¿‡æœŸæ–¹å¼ï¼Œæ¬¢è¿è¡¥å……
```



#### 5ã€fastlane gym produces error: method `to_plist' not defined in Array #11503

```
åœ¨æ‰§è¡Œgymçš„æ—¶å€™å‡ºç°å¦‚ä¸Šé—®é¢˜ï¼Œæˆ–è€…è·‘fastlane action gymçš„æ—¶å€™å‡ºç°

è§£å†³åŠæ³•ï¼šç»ˆç«¯å‘½ä»¤
rvm @global do gem uninstall fastlane 
rvm all do gem uninstall fastlane
gem uninstall fastlane

gem install fastlane

sudo gem install fastlane  (jenkinsæƒé™é—®é¢˜)

ä¾‹å­ï¼š
rvm @global do gem uninstall fastlane

Select gem to uninstall:
 1. fastlane-2.47.0
 2. fastlane-2.49.0
 3. fastlane-2.51.0
 4. fastlane-2.53.1
 5. fastlane-2.55.0
 6. fastlane-2.57.2
 7. fastlane-2.58.0
 8. fastlane-2.62.1
 9. fastlane-2.85.0
 10. fastlane-2.86.2
 11. All versions
> 11
Successfully uninstalled fastlane-2.47.0
Successfully uninstalled fastlane-2.49.0
Successfully uninstalled fastlane-2.51.0
Successfully uninstalled fastlane-2.53.1
Successfully uninstalled fastlane-2.55.0
Successfully uninstalled fastlane-2.57.2
Successfully uninstalled fastlane-2.58.0
Successfully uninstalled fastlane-2.62.1
Successfully uninstalled fastlane-2.85.0
Remove executables:
	bin-proxy, fastlane

in addition to the gem? [Yn]  y
Removing bin-proxy
Removing fastlane
Successfully uninstalled fastlane-2.86.2
[10:42:40] young:~ $ rvm all do gem uninstall fastlane

Select gem to uninstall:
 1. fastlane-2.80.0
 2. fastlane-2.85.0
 3. All versions
> 3
Successfully uninstalled fastlane-2.80.0
Remove executables:
	bin-proxy, fastlane

in addition to the gem? [Yn]  y
Removing bin-proxy
Removing fastlane
Successfully uninstalled fastlane-2.85.0
[10:42:55] young:~ $ gem uninstall fastlane
[10:43:01] young:~ $ gem install fastlane
Fetching: fastlane-2.86.2.gem (100%)
Successfully installed fastlane-2.86.2
Parsing documentation for fastlane-2.86.2
Installing ri documentation for fastlane-2.86.2
Done installing documentation for fastlane after 23 seconds
1 gem installed
```
#### 6ã€é™„å½•ä¸€ä»½ç®€å•çš„fastfileæ–‡ä»¶ï¼Œæ¶‰åŠåˆ°ç§å¯†æ•°æ®éƒ¨åˆ†åœ°æ–¹ä¼šç¬¦å·ä»£æ›¿, ä¸fastlaneæ— å…³çš„éƒ¨åˆ†ä¼šåˆ é™¤ï¼Œæœ¬æ–‡ç”¨çš„æ˜¯Jenkins + fastlane + apphost ï¼Œä»¥ä¸‹æä¾›éƒ¨åˆ†fastfileæ–‡ä»¶ã€Jenkins shellã€æœ¬åœ°è„šæœ¬fastlane.sh

```
fastfile éƒ¨åˆ†
#å£°æ˜

APP_NAME = â€œXXXâ€
WORKSPACE = â€œXXX.xcworkspace"
SCHEME = â€œXXXâ€
IPA_TIME = Time.now.strftime("%Y%m%d_%H%M")
OUTPUT_DIRECTORY = "packages"
APP_INFO_PLIST_PATH = â€˜./XXX/Info.plist'
ENV_PREFIX=""
IPA_NAME = ""

####

platform :ios do

  before_all do
       xcode_select "/Applications/Xcode.app"
       FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT = "40"
  end

  #debugåŒ…
  lane :iosDebug do
    ENV_PREFIX="debug_"
    EXPORT_METHOD = "development"
    package(configuration: "Debug")
  end

  #releaseåŒ…
  lane :iosRelease do
    ENV_PREFIX="adhoc_"
    EXPORT_METHOD = "ad-hoc"
    package(configuration: "Release")
  end

    #å‘å¸ƒåŒ…
  lane :iosAppStore do
    ENV_PREFIX="appstore_"
    EXPORT_METHOD = "app-store"
    package(configuration: "Release")
  end

  #æ‰“åŒ…å‡½æ•°
  lane :package do |option|
      cocoapods
      PLIST_INFO_VERSION = get_version_number(
                                              target: "#{SCHEME}"
                                              )
      PLIST_BUILD_VERSION = get_info_plist_value(path: "#{APP_INFO_PLIST_PATH}", key: 'CFBundleVersion')
      IPA_NAME = "#{ENV_PREFIX}" + "#{APP_NAME}_"  +  "#{IPA_TIME}_" + "#{PLIST_INFO_VERSION}" +"_#{PLIST_BUILD_VERSION}"+ ".ipa"

     #æ‰“åŒ…
     gym(
      scheme: "#{SCHEME}",
      export_method: "#{EXPORT_METHOD}",
      configuration: option[:configuration],
      output_directory: "#{OUTPUT_DIRECTORY}",
      include_symbols: true,
      include_bitcode: false,
      xcargs: 'DEBUG_INFORMATION_FORMAT="dwarf-with-dsym"',
      output_name: "#{IPA_NAME}",
      export_xcargs: "-allowProvisioningUpdates"
      )
      xcclean(
       workspace: "#{WORKSPACE}",
       scheme: "#{SCHEME}"
      )
      
  end


Jenkinséƒ¨åˆ†è„šæœ¬

#!/bin/bash -l
sh ./script/fastlane.sh "Debug"

fastlane.shéƒ¨åˆ†è„šæœ¬

#è§£å†³ArgumentError - invalid byte sequence in US-ASCIIé”™è¯¯
#ä¿®æ”¹ç»ˆç«¯è¯­è¨€ã€åœ°åŒºç­‰å›½é™…åŒ–ç¯å¢ƒå˜é‡
export LANG=en_US.UTF-8
export LANGUAGE=en_US.UTF-8
export LC_ALL=en_US.UTF-8
export PATH=$PATH:/usr/local/bin
#æ›´æ¢rubyç¯å¢ƒï¼Œå¯¹åº”çš„ä¿®æ”¹æœ‰ æ‰“åŒ…æœºä¸‹é¢çš„  .bashrc  .zshrc .zlogin
source $HOME/.rvm/scripts/rvm

#è§£é”keychainï¼Œæ˜¯å…¶å®ƒå·¥å…·å¯ä»¥è®¿é—®è¯ä¹¦ï¼Œè§£é”åè®¾ç½®keychainå…³é—­æ—¶é—´ä¸º1å°æ—¶, xxxä¸ºç”¨æˆ·å
security -v unlock-keychain -p "xxx" "/Users/xxx/Library/Keychains/login.keychain"
security set-keychain-settings -t 3600 -l "/Users/xxx/Library/Keychains/login.keychain"
/usr/local/bin/pod update --verbose --no-repo-update

# fastlane profile
if [[ $1 == "Debug" ]]; then
  fastlane iosDebug
elif [[ $1 == "Release" ]]; then
  fastlane iosRelease
elif [[ $1 == "TestFlight" ]]; then
  fastlane iosTestFlight
elif [[ $1 == "AppStore" ]]; then
  fastlane iosAppStore
fi
```