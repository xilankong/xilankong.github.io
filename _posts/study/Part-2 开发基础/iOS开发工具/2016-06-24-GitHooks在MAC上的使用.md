---
layout: post
title:  "GitHooksåœ¨IOSå¼€å‘ä¸Šçš„ä½¿ç”¨" 
category: iOSæ›´å¤šçŸ¥è¯†
tags: å¼€å‘å·¥å…·
---



## 1.ä»€ä¹ˆæ˜¯ Git Hooks

å¦‚åŒå…¶ä»–è®¸å¤šçš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸€æ ·ï¼ŒGit ä¹Ÿå…·æœ‰åœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œç‰¹å®šè„šæœ¬ä»£ç åŠŸèƒ½ï¼ˆä»æ¦‚å¿µä¸Šç±»æ¯”ï¼Œå°±ä¸ç›‘å¬äº‹ä»¶ã€è§¦å‘å™¨ä¹‹ç±»çš„ä¸œè¥¿ç±»ä¼¼ï¼‰ã€‚[Git Hooks](https://git-scm.com/book/zh/v1/è‡ªå®šä¹‰-Git-GitæŒ‚é’©) å°±æ˜¯é‚£äº›åœ¨Gitæ‰§è¡Œç‰¹å®šäº‹ä»¶ï¼ˆå¦‚commitã€pushã€receiveç­‰ï¼‰åè§¦å‘è¿è¡Œçš„è„šæœ¬ã€‚

![](https://xilankong.github.io/resource/hooks_one.png)

Gité’©å­æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬æ¨è¡Œæäº¤è§„èŒƒï¼Œæ ¹æ®ä»“åº“çŠ¶æ€æ”¹å˜é¡¹ç›®ç¯å¢ƒï¼Œå’Œæ¥å…¥æŒç»­é›†æˆå·¥ä½œæµã€‚ä½†æ˜¯ï¼Œå› ä¸ºè„šæœ¬å¯ä»¥å®Œå…¨å®šåˆ¶ï¼Œä½ å¯ä»¥ç”¨Gité’©å­æ¥è‡ªåŠ¨åŒ–æˆ–è€…ä¼˜åŒ–ä½ å¼€å‘å·¥ä½œæµä¸­ä»»æ„éƒ¨åˆ†ã€‚



## 2.Git Hooks èƒ½åšä»€ä¹ˆ

Git Hooksæ˜¯å®šåˆ¶åŒ–çš„è„šæœ¬ç¨‹åºï¼Œæ‰€ä»¥å®ƒå®ç°çš„åŠŸèƒ½ä¸ç›¸åº”çš„gitåŠ¨ä½œç›¸å…³,å¦‚ä¸‹å‡ ä¸ªç®€å•ä¾‹å­ï¼š

1.å¤šäººå¼€å‘ä»£ç è¯­æ³•ã€è§„èŒƒå¼ºåˆ¶ç»Ÿä¸€

2.commit message æ ¼å¼åŒ–ã€æ˜¯å¦ç¬¦åˆæŸç§è§„èŒƒ

3.å¦‚æœæœ‰éœ€è¦ï¼Œæµ‹è¯•ç”¨ä¾‹çš„æ£€æµ‹

4.æœåŠ¡å™¨ä»£ç æœ‰æ–°çš„æ›´æ–°çš„æ—¶å€™é€šçŸ¥æ‰€æœ‰å¼€å‘æˆå‘˜

5.ä»£ç æäº¤åçš„é¡¹ç›®è‡ªåŠ¨æ‰“åŒ…ï¼ˆgit receiveä¹‹åï¼‰ ç­‰ç­‰...

æ›´å¤šçš„åŠŸèƒ½å¯ä»¥æŒ‰ç…§ç”Ÿäº§ç¯å¢ƒçš„éœ€æ±‚å†™å‡ºæ¥



## 3.Git Hooks æ˜¯å¦‚ä½•å·¥ä½œçš„

æ¯ä¸€ä¸ªä½¿ç”¨äº† git çš„å·¥ç¨‹ä¸‹é¢éƒ½æœ‰ä¸€ä¸ªéšè—çš„ .git æ–‡ä»¶å¤¹ã€‚

![ä¸€ä¸ªå·¥ç¨‹ä¸‹é¢çš„.git](https://xilankong.github.io/resource/git_dir.png)

æŒ‚é’©éƒ½è¢«å­˜å‚¨åœ¨ `.git` ç›®å½•ä¸‹çš„ hooks å­ç›®å½•ä¸­ï¼Œå³å¤§éƒ¨åˆ†é¡¹ç›®ä¸­çš„ .git/hooksã€‚  å¦‚ä¸‹å›¾:

![ä¸€ä¸ªå·¥ç¨‹ä¸‹é¢çš„.git](https://xilankong.github.io/resource/githooks.png)

Git é»˜è®¤ä¼šæ”¾ç½®ä¸€äº›è„šæœ¬æ ·æœ¬åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œé™¤äº†å¯ä»¥ä½œä¸ºæŒ‚é’©ä½¿ç”¨ï¼Œè¿™äº›æ ·æœ¬æœ¬èº«æ˜¯å¯ä»¥ç‹¬ç«‹ä½¿ç”¨çš„ã€‚æ‰€æœ‰çš„æ ·æœ¬éƒ½æ˜¯shellè„šæœ¬ï¼Œå…¶ä¸­ä¸€äº›è¿˜åŒ…å«äº†Perlçš„è„šæœ¬ã€‚ä¸è¿‡ï¼Œä»»ä½•æ­£ç¡®å‘½åçš„å¯æ‰§è¡Œè„šæœ¬éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ ï¼Œä¹Ÿå¯ä»¥ç”¨Rubyæˆ–Pythonï¼Œæˆ–å…¶ä»–è„šæœ¬è¯­è¨€ã€‚

ä¸Šå›¾æ˜¯git åˆå§‹åŒ–çš„æ—¶å€™ç”Ÿæˆçš„é»˜è®¤é’©å­ï¼Œå·²åŒ…å«äº†å¤§éƒ¨åˆ†å¯ä»¥ä½¿ç”¨çš„é’©å­ï¼Œä½†æ˜¯ .sample æ‹“å±•åé˜²æ­¢å®ƒä»¬é»˜è®¤è¢«æ‰§è¡Œã€‚ä¸ºäº†å®‰è£…ä¸€ä¸ªé’©å­ï¼Œä½ åªéœ€è¦å»æ‰ .sample æ‹“å±•åã€‚æˆ–è€…ä½ è¦å†™ä¸€ä¸ªæ–°çš„è„šæœ¬ï¼Œä½ åªéœ€æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åå’Œä¸Šè¿°åŒ¹é…çš„æ–°æ–‡ä»¶ï¼Œå»æ‰.sampleæ‹“å±•åã€‚æŠŠä¸€ä¸ªæ­£ç¡®å‘½åä¸”å¯æ‰§è¡Œçš„æ–‡ä»¶æ”¾å…¥ Git ç›®å½•ä¸‹çš„ hookså­ç›®å½•ä¸­ï¼Œå¯ä»¥æ¿€æ´»è¯¥æŒ‚é’©è„šæœ¬ï¼Œä¹‹åä»–ä¸€ç›´ä¼šè¢« Git è°ƒç”¨ã€‚



**ä¸€ä¸ªç®€å•çš„ Hooks ä¾‹å­**

ä½¿ç”¨shell è¿™é‡Œå°è¯•å†™ä¸€ä¸ªç®€å•çš„é’©å­ï¼Œå®‰è£…ä¸€ä¸ª prepare-commit-msg é’©å­ã€‚å»æ‰è„šæœ¬çš„ .sample æ‹“å±•åï¼Œåœ¨æ–‡ä»¶ä¸­åŠ ä¸Šä¸‹é¢è¿™ä¸¤è¡Œï¼š

```
#!/bin/sh

echo "# Please include a useful commit message!" > $1
```

é’©å­éœ€è¦èƒ½è¢«æ‰§è¡Œï¼Œæ‰€ä»¥å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è„šæœ¬æ–‡ä»¶ï¼Œä½ éœ€è¦ä¿®æ”¹å®ƒçš„æ–‡ä»¶æƒé™ã€‚æ¯”å¦‚è¯´ï¼Œä¸ºäº†ç¡®ä¿prepare-commit-msgå¯æ‰§è¡Œï¼Œè¿è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š

```
chmod + x prepare-commit-msg
```

æ¥ä¸‹æ¥ä½ æ¯æ¬¡è¿è¡Œgit commitæ—¶ï¼Œä½ ä¼šçœ‹åˆ°é»˜è®¤çš„æäº¤ä¿¡æ¯éƒ½è¢«æ›¿æ¢äº†ã€‚

å†…ç½®çš„æ ·ä¾‹è„šæœ¬æ˜¯éå¸¸æœ‰ç”¨çš„å‚è€ƒèµ„æ–™ï¼Œå› ä¸ºæ¯ä¸ªé’©å­ä¼ å…¥çš„å‚æ•°éƒ½æœ‰éå¸¸è¯¦ç»†çš„è¯´æ˜ï¼ˆä¸åŒé’©å­ä¸ä¸€æ ·ï¼‰ã€‚



**è„šæœ¬è¯­è¨€**

gitè‡ªå·±ç”Ÿæˆçš„é»˜è®¤é’©å­çš„è„šæœ¬å¤§å¤šæ˜¯shellå’ŒPerlè¯­è¨€çš„ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•è„šæœ¬è¯­è¨€ï¼Œåªè¦å®ƒä»¬æœ€åèƒ½ç¼–è¯‘åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚æ¯æ¬¡è„šæœ¬ä¸­çš„ #!/bin/sh å®šä¹‰äº†ä½ çš„æ–‡ä»¶å°†è¢«å¦‚ä½•è§£æã€‚æ¯”å¦‚ï¼Œä½¿ç”¨å…¶ä»–è¯­è¨€æ—¶ä½ åªéœ€è¦å°†pathæ”¹ä¸ºä½ çš„è§£é‡Šå™¨çš„è·¯å¾„ã€‚

æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥åœ¨ prepare-commit-msg ä¸­å†™ä¸€ä¸ªå¯æ‰§è¡Œçš„Pythonè„šæœ¬ã€‚ä¸‹é¢è¿™ä¸ªé’©å­å’Œä¸Šä¸€èŠ‚çš„shellè„šæœ¬åšçš„äº‹å®Œå…¨ä¸€æ ·ã€‚

```
#!/usr/bin/env python

import sys, os

commit_msg_filepath = sys.argv[1]
with open(commit_msg_filepath, 'w') as f:
    f.write("# Please include a useful commit message!")
```
æ³¨æ„ç¬¬ä¸€è¡Œæ”¹æˆäº†pythonè§£é‡Šå™¨çš„è·¯å¾„ã€‚æ­¤å¤–ï¼Œè¿™é‡Œç”¨sys.argv[1]è€Œä¸æ˜¯$1æ¥è·å–ç¬¬ä¸€ä¸ªå‚æ•°ã€‚è¿™ä¸ªç‰¹æ€§éå¸¸å¼ºå¤§ï¼Œå› ä¸ºä½ å¯ä»¥ç”¨ä»»ä½•ä½ å–œæ¬¢çš„è¯­è¨€æ¥ç¼–å†™Gité’©å­ã€‚



**é’©å­çš„ä½œç”¨åŸŸ**

å¯¹äºä»»ä½•Gitä»“åº“æ¥è¯´é’©å­éƒ½æ˜¯æœ¬åœ°çš„ï¼Œè€Œä¸”å®ƒä¸ä¼šéšç€git cloneä¸€èµ·å¤åˆ¶åˆ°æ–°çš„ä»“åº“ã€‚è€Œä¸”ï¼Œå› ä¸ºé’©å­æ˜¯æœ¬åœ°çš„ï¼Œä»»ä½•èƒ½æ¥è§¦å¾—åˆ°ä»“åº“çš„äººéƒ½å¯ä»¥ä¿®æ”¹ã€‚åœ¨å¼€å‘å›¢é˜Ÿä¸­ç»´æŠ¤é’©å­æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå› ä¸º.git/hooksç›®å½•ä¸éšä½ çš„é¡¹ç›®ä¸€èµ·æ‹·è´ï¼Œä¹Ÿä¸å—ç‰ˆæœ¬æ§åˆ¶å½±å“ã€‚ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•æ˜¯æŠŠä½ çš„é’©å­å­˜åœ¨é¡¹ç›®çš„å®é™…ç›®å½•ä¸­ï¼ˆåœ¨.gitå¤–ï¼‰ã€‚è¿™æ ·ä½ å°±å¯ä»¥åƒå…¶ä»–æ–‡ä»¶ä¸€æ ·è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚

ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼ŒGitåŒæ ·æä¾›äº†ä¸€ä¸ªæ¨¡æ¿ç›®å½•æœºåˆ¶æ¥æ›´ç®€å•åœ°è‡ªåŠ¨å®‰è£…é’©å­ã€‚æ¯æ¬¡ä½ ä½¿ç”¨ git init æˆ– git clone æ—¶ï¼Œæ¨¡æ¿ç›®å½•æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•éƒ½ä¼šè¢«å¤åˆ¶åˆ°.gitæ–‡ä»¶å¤¹ã€‚




## 4.å®¢æˆ·ç«¯ Hooks

å®¢æˆ·ç«¯é’©å­åªå½±å“å®ƒä»¬æ‰€åœ¨çš„æœ¬åœ°ä»“åº“ã€‚æœ‰è®¸å¤šå®¢æˆ·ç«¯æŒ‚é’©ï¼Œä»¥ä¸‹æŠŠä»–ä»¬åˆ†ä¸ºï¼šæäº¤å·¥ä½œæµæŒ‚é’©ã€ç”µå­é‚®ä»¶å·¥ä½œæµæŒ‚é’©åŠå…¶ä»–å®¢æˆ·ç«¯æŒ‚é’©ã€‚

#### 1.æäº¤å·¥ä½œæµæŒ‚é’©

commitæ“ä½œæœ‰ 4ä¸ªæŒ‚é’©è¢«ç”¨æ¥å¤„ç†æäº¤çš„è¿‡ç¨‹ï¼Œä»–ä»¬çš„è§¦å‘æ—¶é—´é¡ºåºå¦‚ä¸‹ï¼š

pre-commitã€prepare-commit-msgã€commit-msgã€post-commit

commitæ“ä½œæœ€å‰å’Œæœ€åçš„ä¸¤ä¸ªé’©å­æ‰§è¡Œæ—¶é—´å¦‚ä¸‹å›¾ï¼š

![](https://xilankong.github.io/resource/hooks_two.png)

##### pre-commit

pre-commit æŒ‚é’©åœ¨é”®å…¥æäº¤ä¿¡æ¯å‰è¿è¡Œï¼Œæœ€å…ˆè§¦å‘è¿è¡Œçš„è„šæœ¬ã€‚è¢«ç”¨æ¥æ£€æŸ¥å³å°†æäº¤çš„ä»£ç å¿«ç…§ã€‚ä¾‹å¦‚ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ä¸œè¥¿è¢«é—æ¼ã€è¿è¡Œä¸€äº›è‡ªåŠ¨åŒ–æµ‹è¯•ã€ä»¥åŠæ£€æŸ¥ä»£ç è§„èŒƒã€‚å½“ä»è¯¥æŒ‚é’©è¿”å›éé›¶å€¼æ—¶ï¼ŒGit æ”¾å¼ƒæ­¤æ¬¡æäº¤ï¼Œä½†å¯ä»¥ç”¨ git commit --no-verify æ¥å¿½ç•¥ã€‚è¯¥æŒ‚é’©å¯ä»¥è¢«ç”¨æ¥æ£€æŸ¥ä»£ç é”™è¯¯ï¼Œæ£€æŸ¥ä»£ç æ ¼å¼è§„èŒƒï¼Œæ£€æŸ¥å°¾éƒ¨ç©ºç™½ï¼ˆé»˜è®¤æŒ‚é’©æ˜¯è¿™ä¹ˆåšçš„ï¼‰ï¼Œæ£€æŸ¥æ–°æ–¹æ³•ï¼ˆè¯‘æ³¨ï¼šç¨‹åºçš„å‡½æ•°ï¼‰çš„è¯´æ˜ã€‚

pre-commit ä¸éœ€è¦ä»»ä½•å‚æ•°ï¼Œä»¥éé›¶å€¼é€€å‡ºæ—¶å°†æ”¾å¼ƒæ•´ä¸ªæäº¤ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ç”¨ â€œå¼ºåˆ¶ä»£ç æ ¼å¼æ ¡éªŒâ€ æ¥è¯´æ˜ (è§ç¬¬6ç‚¹)ã€‚

##### prepare-commit-msg

prepare-commit-msg æŒ‚é’©åœ¨æäº¤ä¿¡æ¯ç¼–è¾‘å™¨æ˜¾ç¤ºä¹‹å‰ï¼Œé»˜è®¤ä¿¡æ¯è¢«åˆ›å»ºä¹‹åè¿è¡Œï¼Œå®ƒå’Œ pre-commit ä¸€æ ·ï¼Œä»¥éé›¶å€¼é€€å‡ºä¼šæ”¾å¼ƒæäº¤ã€‚å› æ­¤ï¼Œå¯ä»¥æœ‰æœºä¼šåœ¨æäº¤ä½œè€…çœ‹åˆ°é»˜è®¤ä¿¡æ¯å‰è¿›è¡Œç¼–è¾‘ã€‚è¯¥æŒ‚é’©æ¥æ”¶ä¸€äº›é€‰é¡¹ï¼šæ‹¥æœ‰æäº¤ä¿¡æ¯çš„æ–‡ä»¶è·¯å¾„ï¼Œæäº¤ç±»å‹ã€‚ä¾‹å¦‚å’Œæäº¤æ¨¡æ¿é…åˆä½¿ç”¨ï¼Œä»¥ç¼–ç¨‹çš„æ–¹å¼æ’å…¥ä¿¡æ¯ã€‚æäº¤ä¿¡æ¯æ¨¡æ¿çš„æç¤ºä¿®æ”¹åœ¨ä¸Šé¢å·²ç»çœ‹åˆ°äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´æœ‰ç”¨çš„è„šæœ¬ã€‚åœ¨å¤„ç†éœ€è¦å•ç‹¬å¼€æ¥çš„bugæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨å•ç‹¬çš„åˆ†æ”¯ä¸Šå¤„ç†issueã€‚å¦‚æœä½ åœ¨åˆ†æ”¯åä¸­åŒ…å«äº†issueç¼–å·ï¼Œä½ å¯ä»¥ä½¿ç”¨prepare-commit-msgé’©å­æ¥è‡ªåŠ¨åœ°å°†å®ƒåŒ…æ‹¬åœ¨é‚£ä¸ªåˆ†æ”¯çš„æ¯ä¸ªæäº¤ä¿¡æ¯ä¸­ã€‚

```
#!/usr/bin/env python

import sys, os, re
from subprocess import check_output

# æ”¶é›†å‚æ•°
commit_msg_filepath = sys.argv[1]
if len(sys.argv) > 2:
    commit_type = sys.argv[2]
else:
    commit_type = ''
if len(sys.argv) > 3:
    commit_hash = sys.argv[3]
else:
    commit_hash = ''

print "prepare-commit-msg: File: %s\nType: %s\nHash: %s" % (commit_msg_filepath, commit_type, commit_hash)

# æ£€æµ‹æˆ‘ä»¬æ‰€åœ¨çš„åˆ†æ”¯
branch = check_output(['git', 'symbolic-ref', '--short', 'HEAD']).strip()
print "prepare-commit-msg: On branch '%s'" % branch

# ç”¨issueç¼–å·ç”Ÿæˆæäº¤ä¿¡æ¯
if branch.startswith('issue-'):
    print "prepare-commit-msg: Oh hey, it's an issue branch."
    result = re.match('issue-(.*)', branch)
    issue_number = result.group(1)

    with open(commit_msg_filepath, 'r+') as f:
        content = f.read()
        f.seek(0, 0)
        f.write("ISSUE-%s %s" % (issue_number, content))
```

é¦–å…ˆï¼Œä¸Šé¢çš„ prepare-commit-msg é’©å­å‘Šè¯‰ä½ å¦‚ä½•æ”¶é›†ä¼ å…¥è„šæœ¬çš„æ‰€æœ‰å‚æ•°ã€‚æ¥ä¸‹æ¥ï¼Œå®ƒè°ƒç”¨äº†git symbolic-ref --short HEAD æ¥è·å–å¯¹åº”HEADçš„åˆ†æ”¯åã€‚å¦‚æœåˆ†æ”¯åä»¥issue-å¼€å¤´ï¼Œå®ƒä¼šé‡å†™æäº¤ä¿¡æ¯æ–‡ä»¶ï¼Œåœ¨ç¬¬ä¸€è¡ŒåŠ ä¸Šissueç¼–å·ã€‚æ¯”å¦‚ä½ çš„åˆ†æ”¯åissue-224ï¼Œä¸‹é¢çš„æäº¤ä¿¡æ¯å°†ä¼šç”Ÿæˆ:

```
ISSUE-224 

# Please enter the commit message for your changes. Lines starting 
# with '#' will be ignored, and an empty message aborts the commit. 
# On branch issue-224 
# Changes to be committed: 
# modified:   test.txt
```

æœ‰ä¸€ç‚¹è¦è®°ä½çš„æ˜¯å³ä½¿ç”¨æˆ·ç”¨-mä¼ å…¥æäº¤ä¿¡æ¯ï¼Œprepare-commit-msgä¹Ÿä¼šè¿è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨æ’å…¥ISSUE-[#]å­—ç¬¦ä¸²ï¼Œè€Œç”¨æˆ·æ— æ³•æ›´æ”¹ã€‚ä½ å¯ä»¥æ£€æŸ¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¦æ˜¯æäº¤ç±»å‹æ¥å¤„ç†è¿™ä¸ªæƒ…å†µã€‚ä½†æ˜¯ï¼Œå¦‚æœæ²¡æœ‰-mé€‰é¡¹ï¼Œprepare-commit-msgé’©å­å…è®¸ç”¨æˆ·ä¿®æ”¹ç”Ÿæˆåçš„æäº¤ä¿¡æ¯ã€‚æ‰€ä»¥è¿™ä¸ªè„šæœ¬çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œè€Œä¸æ˜¯æ¨è¡Œå¼ºåˆ¶çš„æäº¤ä¿¡æ¯è§„èŒƒã€‚å¦‚æœä½ è¦è¿™ä¹ˆåšï¼Œä½ éœ€è¦ä¸‹é¢æ‰€è®²çš„ commit-msg é’©å­ã€‚

##### commit-msg

commit-msgé’©å­å’Œprepare-commit-msgé’©å­å¾ˆåƒï¼Œä½†å®ƒä¼šåœ¨ç”¨æˆ·è¾“å…¥æäº¤ä¿¡æ¯ä¹‹åè¢«è°ƒç”¨ã€‚è¿™é€‚åˆç”¨æ¥æé†’å¼€å‘è€…ä»–ä»¬çš„æäº¤ä¿¡æ¯ä¸ç¬¦åˆä½ å›¢é˜Ÿçš„è§„èŒƒã€‚ä¼ å…¥è¿™ä¸ªé’©å­å”¯ä¸€çš„å‚æ•°æ˜¯åŒ…å«æäº¤ä¿¡æ¯çš„æ–‡ä»¶åã€‚å¦‚æœå®ƒä¸å–œæ¬¢ç”¨æˆ·è¾“å…¥çš„æäº¤ä¿¡æ¯ï¼Œå®ƒå¯ä»¥åœ¨åŸåœ°ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ï¼ˆå’Œprepare-commit-msgä¸€æ ·ï¼‰ï¼Œæˆ–è€…å®ƒä¼šä»¥éé›¶å€¼é€€å‡ºï¼Œæ”¾å¼ƒè¿™ä¸ªæäº¤ã€‚æ¯”å¦‚è¯´ï¼Œä¸‹é¢è¿™ä¸ªè„šæœ¬ç¡®è®¤ç”¨æˆ·æ²¡æœ‰åˆ é™¤prepare-commit-msgè„šæœ¬è‡ªåŠ¨ç”Ÿæˆçš„ISSUE-[#]å­—ç¬¦ä¸²ã€‚

```
#!/usr/bin/env python

import sys, os, re
from subprocess import check_output

# æ”¶é›†å‚æ•°
commit_msg_filepath = sys.argv[1]

# æ£€æµ‹æ‰€åœ¨çš„åˆ†æ”¯
branch = check_output(['git', 'symbolic-ref', '--short', 'HEAD']).strip()
print "commit-msg: On branch '%s'" % branch

# æ£€æµ‹æäº¤ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªissueæäº¤
if branch.startswith('issue-'):
    print "commit-msg: Oh hey, it's an issue branch."
    result = re.match('issue-(.*)', branch)
    issue_number = result.group(1)
    required_message = "ISSUE-%s" % issue_number

    with open(commit_msg_filepath, 'r') as f:
        content = f.read()
        if not content.startswith(required_message):
            print "commit-msg: ERROR! The commit message must start with '%s'" % required_message
            sys.exit(1)
```

##### post-commit

post-commit æŒ‚é’©åœ¨æ•´ä¸ªæäº¤è¿‡ç¨‹å®Œæˆåè¿è¡Œï¼Œä»–ä¸ä¼šæ¥æ”¶ä»»ä½•å‚æ•°ï¼Œä½†å¯ä»¥è¿è¡Œ  git  log æ¥è·å¾—æœ€åçš„æäº¤ä¿¡æ¯ã€‚æ€»ä¹‹ï¼Œè¯¥æŒ‚é’©æ˜¯ä½œä¸ºé€šçŸ¥ä¹‹ç±»ä½¿ç”¨çš„ã€‚è™½ç„¶å¯ä»¥ç”¨post-commitæ¥è§¦å‘æœ¬åœ°çš„æŒç»­é›†æˆç³»ç»Ÿï¼Œä½†å¤§å¤šæ•°æ—¶å€™ä½ æƒ³ç”¨çš„æ˜¯post-receiveè¿™ä¸ªé’©å­ã€‚å®ƒè¿è¡Œåœ¨æœåŠ¡ç«¯è€Œä¸æ˜¯ç”¨æˆ·çš„æœ¬åœ°æœºå™¨ï¼Œå®ƒåŒæ ·åœ¨ä»»ä½•å¼€å‘è€…æ¨é€ä»£ç æ—¶è¿è¡Œã€‚é‚£é‡Œæ›´é€‚åˆè¿›è¡ŒæŒç»­é›†æˆã€‚

æäº¤å·¥ä½œæµçš„å®¢æˆ·ç«¯æŒ‚é’©è„šæœ¬å¯ä»¥åœ¨ä»»ä½•å·¥ä½œæµä¸­ä½¿ç”¨ï¼Œä»–ä»¬ç»å¸¸è¢«ç”¨æ¥å®æ–½æŸäº›ç­–ç•¥ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›è„šæœ¬åœ¨cloneæœŸé—´ä¸ä¼šè¢«ä¼ é€ã€‚å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯å®æ–½ç­–ç•¥æ¥æ‹’ç»ä¸ç¬¦åˆæŸäº›ç­–ç•¥çš„æ¨é€ï¼Œä½†è¿™å®Œå…¨å–å†³äºå¼€å‘è€…åœ¨å®¢æˆ·ç«¯ä½¿ç”¨è¿™äº›è„šæœ¬çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œè¿™äº›è„šæœ¬å¯¹å¼€å‘è€…æ˜¯æœ‰ç”¨çš„ï¼Œç”±ä»–ä»¬è‡ªå·±è®¾ç½®å’Œç»´æŠ¤ï¼Œè€Œä¸”åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è¦†ç›–æˆ–ä¿®æ”¹è¿™äº›è„šæœ¬ï¼Œåé¢è®²å¦‚ä½•æŠŠè¿™éƒ¨åˆ†ä¸œè¥¿ä¹Ÿé›†æˆåˆ°å¼€å‘æµä¸­ã€‚

#### 2.E-mailå·¥ä½œæµæŒ‚é’©

æœ‰3ä¸ªå¯ç”¨çš„å®¢æˆ·ç«¯æŒ‚é’©ç”¨äºe-mailå·¥ä½œæµã€‚å½“è¿è¡Œ `git am` å‘½ä»¤æ—¶ï¼Œä¼šè°ƒç”¨ä»–ä»¬ï¼Œå› æ­¤ï¼Œå¦‚æœä½ æ²¡æœ‰åœ¨å·¥ä½œæµä¸­ç”¨åˆ°æ­¤å‘½ä»¤ï¼Œå¯ä»¥è·³è¿‡æœ¬èŠ‚ã€‚å¦‚æœä½ é€šè¿‡e-mailæ¥æ”¶ç”± git format-patch äº§ç”Ÿçš„è¡¥ä¸ï¼Œè¿™äº›æŒ‚é’©ä¹Ÿè®¸å¯¹ä½ æœ‰ç”¨ã€‚

é¦–å…ˆè¿è¡Œçš„æ˜¯ `applypatch-msg` æŒ‚é’©ï¼Œä»–æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šåŒ…å«è¢«å»ºè®®æäº¤ä¿¡æ¯çš„ä¸´æ—¶æ–‡ä»¶åã€‚å¦‚æœè¯¥è„šæœ¬éé›¶é€€å‡ºï¼ŒGit æ”¾å¼ƒæ­¤è¡¥ä¸ã€‚å¯ä»¥ä½¿ç”¨è¿™ä¸ªè„šæœ¬ç¡®è®¤æäº¤ä¿¡æ¯æ˜¯å¦è¢«æ­£ç¡®æ ¼å¼åŒ–ï¼Œæˆ–è®©è„šæœ¬ç¼–è¾‘ä¿¡æ¯ä»¥è¾¾åˆ°æ ‡å‡†åŒ–ã€‚

ä¸‹ä¸€ä¸ªåœ¨ git am è¿è¡ŒæœŸé—´è°ƒç”¨æ˜¯ `pre-applypatch` æŒ‚é’©ã€‚è¯¥æŒ‚é’©ä¸æ¥æ”¶å‚æ•°ï¼Œåœ¨è¡¥ä¸è¢«è¿ç”¨ä¹‹åè¿è¡Œï¼Œå› æ­¤ï¼Œå¯ä»¥è¢«ç”¨æ¥åœ¨æäº¤å‰æ£€æŸ¥å¿«ç…§ã€‚ä½ èƒ½ç”¨æ­¤è„šæœ¬è¿è¡Œæµ‹è¯•ï¼Œæ£€æŸ¥å·¥ä½œæ ‘ã€‚å¦‚æœæœ‰äº›ä»€ä¹ˆé—æ¼ï¼Œæˆ–æµ‹è¯•æ²¡é€šè¿‡ï¼Œè„šæœ¬ä¼šä»¥éé›¶é€€å‡ºï¼Œæ”¾å¼ƒæ­¤æ¬¡ git am çš„è¿è¡Œï¼Œè¡¥ä¸ä¸ä¼šè¢«æäº¤ã€‚

æœ€ååœ¨ git am è¿è¡ŒæœŸé—´è°ƒç”¨çš„æ˜¯ `post-applypatch` æŒ‚é’©ã€‚ä½ å¯ä»¥ç”¨ä»–æ¥é€šçŸ¥ä¸€ä¸ªå°ç»„æˆ–è·å–çš„è¡¥ä¸çš„ä½œè€…ï¼Œä½†æ— æ³•é˜»æ­¢æ‰“è¡¥ä¸çš„è¿‡ç¨‹ã€‚

#### 3.å…¶ä»–å®¢æˆ·ç«¯æŒ‚é’©

##### pre-rebase

pre-rebase æŒ‚é’©åœ¨è¡åˆå‰è¿è¡Œï¼Œè„šæœ¬ä»¥éé›¶é€€å‡ºå¯ä»¥ä¸­æ­¢è¡åˆçš„è¿‡ç¨‹ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæŒ‚é’©æ¥ç¦æ­¢è¡åˆå·²ç»æ¨é€çš„æäº¤å¯¹è±¡ï¼Œpre-rebase æŒ‚é’©æ ·æœ¬å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚è¯¥æ ·æœ¬å‡å®šnextæ˜¯ä½ å®šä¹‰çš„åˆ†æ”¯åï¼Œå› æ­¤ï¼Œä½ å¯èƒ½è¦ä¿®æ”¹æ ·æœ¬ï¼ŒæŠŠnextæ”¹æˆä½ å®šä¹‰è¿‡ä¸”ç¨³å®šçš„åˆ†æ”¯åã€‚

æ¯”å¦‚è¯´ï¼Œå¦‚æœä½ æƒ³å½»åº•ç¦ç”¨rebaseæ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„pre-rebaseè„šæœ¬ï¼š

```
#!/bin/sh

# ç¦ç”¨æ‰€æœ‰rebase
echo "pre-rebase: Rebasing is dangerous. Don't do it."
exit 1
```

æ¯æ¬¡è¿è¡Œgit rebaseï¼Œä½ éƒ½ä¼šçœ‹åˆ°ä¸‹é¢çš„ä¿¡æ¯ï¼š

```
pre-rebase: Rebasing is dangerous. Don't do it.
The pre-rebase hook refused to rebase.
```

å†…ç½®çš„pre-rebase.sampleè„šæœ¬æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚å®ƒåœ¨ä½•æ—¶é˜»æ­¢rebaseè¿™æ–¹é¢æ›´åŠ æ™ºèƒ½ã€‚å®ƒä¼šæ£€æŸ¥ä½ å½“å‰çš„åˆ†æ”¯æ˜¯å¦å·²ç»åˆå¹¶åˆ°äº†ä¸‹ä¸€ä¸ªåˆ†æ”¯ä¸­å»ï¼ˆä¹Ÿå°±æ˜¯ä¸»åˆ†æ”¯ï¼‰ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œrebaseå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ï¼Œè„šæœ¬ä¼šæ”¾å¼ƒè¿™æ¬¡rebaseã€‚

##### post-checkout

ç”±git checkoutå‘½ä»¤è°ƒç”¨ï¼Œåœ¨å®Œæˆå·¥ä½œåŒºæ›´æ–°ä¹‹åæ‰§è¡Œã€‚è¯¥è„šæœ¬ç”±ä¸‰ä¸ªå‚æ•°ï¼šä¹‹å‰HEADæŒ‡å‘çš„å¼•ç”¨ï¼Œæ–°çš„HEADæŒ‡å‘çš„å¼•ç”¨ï¼Œä¸€ä¸ªç”¨äºæ ‡è¯†æ­¤æ¬¡æ£€å‡ºæ˜¯å¦æ˜¯åˆ†æ”¯æ£€å‡ºçš„å€¼ï¼ˆ0è¡¨ç¤ºæ–‡ä»¶æ£€å‡ºï¼Œ1è¡¨ç¤ºåˆ†æ”¯æ£€å‡ºï¼‰ã€‚ä¹Ÿå¯ä»¥è¢«git cloneè§¦å‘è°ƒç”¨ï¼Œé™¤éåœ¨å…‹éš†æ—¶ä½¿ç”¨å‚æ•°--no-checkoutã€‚åœ¨ç”±cloneè°ƒç”¨æ‰§è¡Œæ—¶ï¼Œä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºnull, 1, 1ã€‚è¿™ä¸ªè„šæœ¬å¯ä»¥ç”¨äºä¸ºè‡ªå·±çš„é¡¹ç›®è®¾ç½®åˆé€‚çš„å·¥ä½œåŒºï¼Œæ¯”å¦‚è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ã€ç§»åŠ¨ä¸€äº›å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ£€æŸ¥ç‰ˆæœ¬åº“çš„æœ‰æ•ˆæ€§ã€‚

æœ€åï¼Œåœ¨ merge å‘½ä»¤æˆåŠŸæ‰§è¡Œåï¼Œ`post-merge` æŒ‚é’©ä¼šè¢«è°ƒç”¨ã€‚ä»–å¯ä»¥ç”¨æ¥åœ¨ Git æ— æ³•è·Ÿè¸ªçš„å·¥ä½œæ ‘ä¸­æ¢å¤æ•°æ®ï¼Œè¯¸å¦‚æƒé™æ•°æ®ã€‚è¯¥æŒ‚é’©åŒæ ·èƒ½å¤ŸéªŒè¯åœ¨ Git æ§åˆ¶ä¹‹å¤–çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå› æ­¤ï¼Œå½“å·¥ä½œæ ‘æ”¹å˜æ—¶ï¼Œä½ æƒ³è¿™äº›æ–‡ä»¶å¯ä»¥è¢«å¤åˆ¶ã€‚



## 5.æœåŠ¡å™¨ç«¯ Hooks

é™¤äº†å®¢æˆ·ç«¯æŒ‚é’©ï¼Œä½œä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæœåŠ¡å™¨ç«¯çš„æŒ‚é’©å¯¹é¡¹ç›®å®æ–½å„ç§ç±»å‹çš„ç­–ç•¥ã€‚è¿™äº›æŒ‚é’©è„šæœ¬å¯ä»¥åœ¨æäº¤å¯¹è±¡æ¨é€åˆ°æœåŠ¡å™¨å‰è¢«è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æ¨é€åˆ°æœåŠ¡å™¨åè¢«è°ƒç”¨ã€‚æ¨é€åˆ°æœåŠ¡å™¨å‰è°ƒç”¨çš„æŒ‚é’©å¯ä»¥åœ¨ä»»ä½•æ—¶å€™ä»¥éé›¶é€€å‡ºï¼Œæ‹’ç»æ¨é€ï¼Œè¿”å›é”™è¯¯æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œè¿˜å¯ä»¥å¦‚ä½ æ‰€æ„¿è®¾ç½®è¶³å¤Ÿå¤æ‚çš„æ¨é€ç­–ç•¥ã€‚

#### pre-receive

å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„æ¨é€ï¼ˆpushï¼‰æ“ä½œæ—¶æœ€å…ˆæ‰§è¡Œçš„è„šæœ¬å°±æ˜¯ `pre-receive` ã€‚å®ƒä»æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰è·å–è¢«æ¨é€å¼•ç”¨çš„åˆ—è¡¨ï¼›å¦‚æœå®ƒé€€å‡ºæ—¶çš„è¿”å›å€¼ä¸æ˜¯0ï¼Œæ‰€æœ‰æ¨é€å†…å®¹éƒ½ä¸ä¼šè¢«æ¥å—ã€‚åˆ©ç”¨æ­¤æŒ‚é’©è„šæœ¬å¯ä»¥å®ç°ç±»ä¼¼ä¿è¯æœ€æ–°çš„ç´¢å¼•ä¸­ä¸åŒ…å«é fast-forward ç±»å‹çš„è¿™ç±»æ•ˆæœï¼›æŠ‘æˆ–æ£€æŸ¥æ‰§è¡Œæ¨é€æ“ä½œçš„ç”¨æˆ·æ‹¥æœ‰åˆ›å»ºï¼Œåˆ é™¤æˆ–è€…æ¨é€çš„æƒé™æˆ–è€…ä»–æ˜¯å¦å¯¹å°†è¦ä¿®æ”¹çš„æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æœ‰è®¿é—®æƒé™ã€‚

```
#!/usr/bin/env python

import sys
import fileinput

# è¯»å–ç”¨æˆ·è¯•å›¾æ›´æ–°çš„æ‰€æœ‰å¼•ç”¨
for line in fileinput.input():
    print "pre-receive: Trying to push ref: %s" % line

# æ”¾å¼ƒæ¨é€
# sys.exit(1)
```

#### post-receive

post-receive æŒ‚é’©åœ¨æ•´ä¸ªè¿‡ç¨‹å®Œç»“ä»¥åè¿è¡Œï¼Œå¯ä»¥ç”¨æ¥æ›´æ–°å…¶ä»–ç³»ç»ŸæœåŠ¡æˆ–è€…é€šçŸ¥ç”¨æˆ·ã€‚å®ƒæ¥å—ä¸ pre-receive ç›¸åŒçš„æ ‡å‡†è¾“å…¥æ•°æ®ã€‚åº”ç”¨å®ä¾‹åŒ…æ‹¬ç»™æŸé‚®ä»¶åˆ—è¡¨å‘ä¿¡ï¼Œé€šçŸ¥å®æ—¶æ•´åˆæ•°æ®çš„æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´æ–°è½¯ä»¶é¡¹ç›®çš„é—®é¢˜è¿½è¸ªç³»ç»Ÿ â€”â€” ç”šè‡³å¯ä»¥é€šè¿‡åˆ†ææäº¤ä¿¡æ¯æ¥å†³å®šæŸä¸ªé—®é¢˜æ˜¯å¦åº”è¯¥è¢«å¼€å¯ï¼Œä¿®æ”¹æˆ–è€…å…³é—­ã€‚è¯¥è„šæœ¬æ— æ³•ç»„ç»‡æ¨é€è¿›ç¨‹ï¼Œä¸è¿‡å®¢æˆ·ç«¯åœ¨å®ƒå®Œæˆè¿è¡Œä¹‹å‰å°†ä¿æŒè¿æ¥çŠ¶æ€ï¼›æ‰€ä»¥åœ¨ç”¨å®ƒä½œä¸€äº›æ¶ˆè€—æ—¶é—´çš„æ“ä½œä¹‹å‰è¯·ä¸‰æ€ã€‚

#### update

update è„šæœ¬å’Œ pre-receive è„šæœ¬ååˆ†ç±»ä¼¼ã€‚ä¸åŒä¹‹å¤„åœ¨äºå®ƒä¼šä¸ºæ¨é€è€…æ›´æ–°çš„æ¯ä¸€ä¸ªåˆ†æ”¯è¿è¡Œä¸€æ¬¡ã€‚å‡å¦‚æ¨é€è€…åŒæ—¶å‘å¤šä¸ªåˆ†æ”¯æ¨é€å†…å®¹ï¼Œpre-receive åªè¿è¡Œä¸€æ¬¡ï¼Œç›¸æ¯”ä¹‹ä¸‹ update åˆ™ä¼šä¸ºæ¯ä¸€ä¸ªæ›´æ–°çš„åˆ†æ”¯è¿è¡Œä¸€æ¬¡ã€‚å®ƒä¸ä¼šä»æ ‡å‡†è¾“å…¥è¯»å–å†…å®¹ï¼Œè€Œæ˜¯æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šç´¢å¼•çš„åå­—ï¼ˆåˆ†æ”¯ï¼‰ï¼Œæ¨é€å‰ç´¢å¼•æŒ‡å‘çš„å†…å®¹çš„ SHA-1 å€¼ï¼Œä»¥åŠç”¨æˆ·è¯•å›¾æ¨é€å†…å®¹çš„ SHA-1 å€¼ã€‚å¦‚æœ update è„šæœ¬ä»¥é€€å‡ºæ—¶è¿”å›éé›¶å€¼ï¼Œåªæœ‰ç›¸åº”çš„é‚£ä¸€ä¸ªç´¢å¼•ä¼šè¢«æ‹’ç»ï¼›å…¶ä½™çš„ä¾ç„¶ä¼šå¾—åˆ°æ›´æ–°ã€‚

## 6.ä½¿ç”¨Hooks-å®¢æˆ·ç«¯ä»£ç è§„èŒƒï¼ˆOCï¼‰

ç»Ÿä¸€çš„ä»£ç è§„èŒƒè®©ä»£ç æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚åœ¨æ§åˆ¶ä»£ç è§„èŒƒæ–¹é¢å¯ä»¥æ‰§è¡Œçš„å°±æ˜¯ ï¼š

> 1.ç¨‹åºå‘˜è‡ªå·±æ§åˆ¶ï¼ˆå®šæœŸcode reviewï¼‰
>
> 2.è‡ªåŠ¨åŒ–æ£€æµ‹ (å¤šäººåä½œä»£ç æäº¤çš„æ—¶å€™å¼ºåˆ¶æ£€æµ‹ä»£ç è§„èŒƒï¼Œä¸ç¬¦åˆä¸è®©æäº¤)

è¿™é‡Œå°±ä¾èµ–ç€ spacecommander å’Œ hooks çš„ç»“åˆ å®ç°ä»£ç æäº¤ä¹‹å‰çš„ä»£ç æ ¼å¼è§„èŒƒæ£€æµ‹ã€‚

#### 1.ä¸‹è½½ spacecommander

```
git clone https://github.com/square/spacecommander.git
```

ä¸‹å›¾å°±æ˜¯æˆ‘ä»¬cloneä¸‹æ¥çš„ spacecommander çš„æ–‡ä»¶å¤¹å†…å®¹,å…¶ä¸­åŒ…æ‹¬ä¸€äº› shell è„šæœ¬æ–‡ä»¶,è¿˜æœ‰ python è„šæœ¬æ–‡ä»¶,(å…¶ä¸­ shell ä¸»è¦æ˜¯æ¥è°ƒç”¨ python è„šæœ¬çš„),å…¶ä¸­è¿˜æœ‰ä¸€ä¸ªæœ€é‡è¦çš„éšè—æ–‡ä»¶ `.clang-format` (è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨é…ç½®ä»£ç è§„èŒƒçš„,é‡‡ç”¨ YMAL æ ‡è®°è¯­è¨€ä¹¦å†™).

![](https://xilankong.github.io/resource/space.png)



#### 2.åœ¨é¡¹ç›®ä»“åº“ä¸­å®‰è£…spacecommander

æˆ‘ä»¬è¿›å…¥é¡¹ç›®ç›®å½• è¿è¡Œ spacecommander ä»“åº“ä¸­çš„ `setup-repo.sh` è„šæœ¬

æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š

![](https://xilankong.github.io/resource/setup_space.png)



ç¬¬ä¸€ä¸ªçº¢åœˆå¤„åœ°å€ä¸ºæˆ‘é¡¹ç›®å·¥ç¨‹æ‰€åœ¨ç›®å½• æ‰§è¡Œçš„ setup-repo.sh  éœ€è¦å– spacecommander ç›®å½•åœ°å€ã€‚

ç¬¬äºŒä¸ªçº¢åœˆå¤„å¯ä»¥çœ‹åˆ°  setup-repo.sh  å‘½ä»¤çš„æ‰§è¡Œ 

åœ¨ é¡¹ç›®ç›®å½•ä¸‹çš„ .git/hooks ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ª `pre-commit` æ–‡ä»¶ï¼ˆå¯æ‰§è¡Œé’©å­æ–‡ä»¶ï¼‰

åŒæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª `.clang-format` æ–‡ä»¶

å…¶ä¸­ `.clang-format` åªæ˜¯ä¸€ä¸ªæ–‡ä»¶é“¾æ¥,æŒ‡å‘äº†æˆ‘ä»¬çš„ spacecommander ä»“åº“ä¸­çš„è¿™ä¸ªæ–‡ä»¶,è¿™ä¸ªæ–‡ä»¶ä¸»è¦ç”¨æ¥é…ç½®è§„èŒƒçš„é€‰é¡¹ã€‚æœ€é‡è¦çš„ä¸€ä¸ªæ–‡ä»¶æ˜¯ .git éšè—æ–‡ä»¶å¤¹ä¸‹çš„ hookæ–‡ä»¶å¤¹ä¸­çš„ `pre-commit` è„šæœ¬,è¿™ä¸ªè„šæœ¬ä¼šåœ¨ git commit ä¹‹å‰æ‰§è¡Œç”¨æ¥æ£€æµ‹ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚

```
#!/usr/bin/env bash
current_repo_path=$(git rev-parse --show-toplevel)
repo_to_format="/Users/young/Desktop/demo/demoWebView"
if [ "$current_repo_path" == "$repo_to_format" ] && 
[ -e "/Users/young/desktop/demo/spacecommander"/format-objc-hook ]; 
then "/Users/young/desktop/demo/spacecommander"/format-objc-hook; fi
```

ä¸Šé¢çš„ shell ä»£ç  å¤§è‡´çš„æ„æ€å°±æ˜¯ å¯¹æˆ‘ä»¬æŒ‡å®šçš„ç›®å½• æ‰§è¡Œ format-objc-hook è„šæœ¬æ–‡ä»¶å»æ ¡éªŒï¼Œè€Œè¿™ä¸ªformat-objc-hook è„šæœ¬æ–‡ä»¶ä¸»è¦æ˜¯ç”¨æ¥æ£€æµ‹è¿™ä¸ªè¿™æ¬¡æäº¤çš„å˜åŒ–ä¸­æ˜¯å¦æœ‰ä¸ç¬¦åˆä»£ç è§„èŒƒçš„ä»£ç ,å¦‚æœæœ‰å°± commit å¤±è´¥,å¦‚æœæ²¡æœ‰å°± commit æˆåŠŸã€‚

#### 3.æäº¤ä»£ç +ä»£ç æ£€æµ‹+ä»£ç è‡ªåŠ¨fix

```
ğŸš¸ Format and stage individual files:
"/Users/young/desktop/demo/spacecommander"/format-objc-file.sh 'demoWebView/ViewController.m' && git add 'demoWebView/ViewController.m';

ğŸš€  Format and stage all affected files:
	 "/Users/young/desktop/demo/spacecommander"/format-objc-files.sh -s

ğŸ”´  There were formatting issues with this commit, run theğŸ‘† aboveğŸ‘† command to fix.
ğŸ’”  Commit anyway and skip this check by running git commit --no-verify
yanghuangdeMac-mini:demoWebView young$ 
```

å¦‚ä¸Šå›¾ç»“æœ æäº¤å‘½ä»¤ `git commit -m "mod"` ä¹‹å æäº¤å¹¶æœªæˆåŠŸå¹¶è¿”å›äº†é”™è¯¯ï¼Œé”™è¯¯æ¸…æ¥šçš„å‘Šè¯‰æˆ‘ä»¬æ ¼å¼ä¸å¯¹çš„æäº¤æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰é”™è¯¯æç¤ºä¸­å¾—æ“ä½œå‘½ä»¤å» å•ç‹¬æ ¼å¼åŒ–ä¸€ä¸ªæ–‡ä»¶ æˆ–è€…æ•´ä¸ªé¡¹ç›®ã€‚

#### 4.è‡ªå®šä¹‰ä»£ç è§„èŒƒæ–‡ä»¶

[clang-format](http://clang.llvm.org/doxygen/structclang_1_1format_1_1FormatStyle.html) è§„èŒƒ

```
IndentNestedBlocks: false
AllowNewlineBeforeBlockParameter: false

Language:        Cpp
# BasedOnStyle:  Google # åŸºç¡€æ ·å¼
AccessModifierOffset: -1 #ç±»çš„è®¿é—®ä¿®é¥°å…³é”®å­—(private,public,protectedÂ·Â·Â·)ç¼©è¿›
# private:
# int a;
# 1è¡¨ç¤ºä¸ç¼©è¿›
#å¤§äº1çš„å€¼è¡¨ç¤ºè®¿é—®ä¿®é¥°å…³é”®å­—çš„å·¦ä¾§ä»int açš„å·¦ä¾§åˆ—å¼€å§‹å¾€å³ä¾§ç§»åŠ¨çš„è·ç¦»

ConstructorInitializerIndentWidth: 4
SortIncludes: false

AlignAfterOpenBracket: true #åœ¨æœªå°é—­(æ‹¬å·çš„å¼€å§‹å’Œç»“æŸä¸åœ¨åŒä¸€è¡Œ)çš„æ‹¬å·ä¸­çš„ä»£ç æ˜¯å¦å¯¹é½
# if(a &&
#    b)
# 

AlignEscapedNewlinesLeft: true #å¦‚æœæ˜¯trueå°±æ˜¯å·¦å¯¹é½,å¦‚æœæ˜¯falseå°±æ˜¯å³å¯¹é½ å¦‚ä¸‹ï¼š
# void foo() {
#        someFunction();
#  someOtherFunction();
# }//false
# void foo() {
#    someFunction();
#    someOtherFunction();
# }//true

AlignOperands: false #æ°´å¹³å¯¹é½äºŒè¿›åˆ¶å’Œä¸‰å…ƒè¡¨è¾¾å¼

AlignTrailingComments: true  
#æ˜¯å¦æŠŠæ³¨é‡Šå³å¯¹é½,ä¸‹é¢ä¸ºå³å¯¹é½çš„æ•ˆæœ
#void someFunction() {
#    doWork();     // Does something
#    doMoreWork(); // Does something else
#}

AlignConsecutiveAssignments: false  #å¤šè¡Œèµ‹å€¼è¯­å¥æŒ‰=å·å¯¹é½
AlignConsecutiveDeclarations: false #å¤šè¡Œå£°æ˜è¯­å¥æŒ‰=å·å¯¹é½

AllowAllParametersOfDeclarationOnNextLine: false #å‚æ•°çš„å¯¹é½æ–¹å¼ å¦‚æœTRUEå°±è®©å‚æ•°ä¸Šä¸‹å¯¹é½ å¦åˆ™å°†æ˜¯é»˜è®¤
# someFunction(foo,
#              bar,
#              baz);//true
#
# someFunction(foo, bar, baz);//false
#

AllowShortBlocksOnASingleLine: false #æ˜¯å¦å…è®¸çŸ­ä»£ç å—åœ¨ä¸€è¡Œå†™å®Œ#å¦‚ if (a) { return; }
AllowShortCaseLabelsOnASingleLine: false #æ˜¯å¦å…è®¸çŸ­switchçš„case è¯­å¥åœ¨ä¸€è¡Œå†™å®Œ
AllowShortFunctionsOnASingleLine: true #æ˜¯å¦å…è®¸çŸ­çš„å‡½æ•°åœ¨ä¸€è¡Œå†™å®Œ
AllowShortIfStatementsOnASingleLine: true #æ˜¯å¦å…è®¸çŸ­çš„è¯­å¥åœ¨ä¸€è¡Œå†™å®Œ
AllowShortFunctionsOnASingleLine: All
AllowShortLoopsOnASingleLine: true #æ˜¯å¦å…è®¸çŸ­çš„å¾ªç¯åœ¨ä¸€è¡Œå†™å®Œ

AlwaysBreakAfterDefinitionReturnType: false
AlwaysBreakTemplateDeclarations: false

AlwaysBreakBeforeMultilineStrings: false #åœ¨å¤šè¡Œå­—ç¬¦ä¸²ä¹‹å‰æ€»æ˜¯æ‰“ç ´ å¦‚ä¸‹ true
# NSString *string = 
# @"deqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwde"                        # @"qwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeqwdeq"
# @"wdeqwdeqw";

BreakBeforeBinaryOperators: None #åœ¨äºŒå…ƒè¿ç®—ç¬¦å‰æ–­è¡Œ
BreakBeforeTernaryOperators: false #åœ¨ä¸‰å…ƒè¿ç®—ç¬¦å‰æ–­è¡Œ
BreakConstructorInitializersBeforeComma: false #åœ¨æ„é€ å‡½æ•°åˆå§‹åŒ–æ—¶æŒ‰é€—å·æ–­è¡Œï¼Œå¹¶ä»¥å†’å·å¯¹é½

BinPackArguments: true
BinPackParameters: true
ColumnLimit: 0 #æœ€å¤§å®½åº¦,å¦‚æœä»£ç è¶…è¿‡è¿™ä¸ªå®½åº¦ä¼šæŒ‰è¯­ä¹‰æŠ˜è¡Œ 0æ„å‘³ç€æ²¡æœ‰é™åˆ¶
ConstructorInitializerAllOnOneLineOrOnePerLine: true
DerivePointerAlignment: false
ExperimentalAutoDetectBinPacking: false
IndentCaseLabels: true  #caseè¯­å¥çš„ä½ç½®æ€»æ˜¯åœ¨switchè¯­å¥åç¼©è¿›ä¸€çº§
IndentWrappedFunctionNames: false
IndentFunctionDeclarationAfterType: false
MaxEmptyLinesToKeep: 2 #å…è®¸æœ€å¤§è¿ç»­ç©ºè¡Œæ•°
KeepEmptyLinesAtTheStartOfBlocks: false #blockä»ç©ºè¡Œå¼€å§‹
NamespaceIndentation: Inner #å‘½åç©ºé—´ç¼©è¿›
ObjCBlockIndentWidth: 4 #blockå†…çš„ç¼©è¿›å¤§å°
ObjCSpaceAfterProperty: true #æ˜¯å¦éœ€è¦åœ¨"@property"ååŠ ä¸Šç©ºæ ¼
ObjCSpaceBeforeProtocolList: true #æ˜¯å¦éœ€è¦åœ¨åè®®åååŠ ä¸Šç©ºæ ¼
PenaltyBreakBeforeFirstCallParameter: 10000
PenaltyBreakComment: 300
PenaltyBreakString: 1000
PenaltyBreakFirstLessLess: 120
PenaltyExcessCharacter: 1000000 #æœ€å¤šèƒ½è¶…å‡ºColumnLimitå¤šå°‘ä¸ªå­—ç¬¦
PenaltyReturnTypeOnItsOwnLine: 200
PointerAlignment: Right #æŒ‡é’ˆåœ¨ç±»å‹é‚£è¾¹è¿˜æ˜¯åœ¨å˜é‡åé‚£è¾¹è¿˜æ˜¯åœ¨ä¸­é—´
SpacesBeforeTrailingComments: 1 #å•è¡Œæ³¨é‡Šå‰çš„ç©ºæ ¼æ•°
Cpp11BracedListStyle: true
Standard:        Auto
IndentWidth:     4
TabWidth:        8
UseTab:          Never #æ˜¯å¦ä½¿ç”¨tabè¿›è¡Œç¼©è¿›
BreakBeforeBraces: Custom # åœ†æ‹¬å·çš„æ¢è¡Œæ–¹å¼
BraceWrapping: 
    AfterClass: true
    AfterControlStatement: false
    AfterEnum: false
    AfterFunction: true
    AfterNamespace: true
    AfterObjCDeclaration: true
    AfterStruct: false
    AfterUnion: false
    BeforeCatch: false
    BeforeElse: false
    IndentBraces: false

SpacesInParentheses: false #æ˜¯å¦åœ¨éç©ºçš„æ‹¬å·ä¸­æ’å…¥ç©ºæ ¼
SpacesInSquareBrackets: false
SpacesInAngles:  false #æ˜¯å¦åœ¨<>ä¸­é—´æ’å…¥ç©ºæ ¼
SpaceInEmptyParentheses: false  #æ˜¯å¦åœ¨ç©ºæ‹¬å·ä¸­åŠ ç©ºæ ¼
SpacesInCStyleCastParentheses: false
SpaceAfterCStyleCast: false
SpacesInContainerLiterals: true #æ˜¯å¦åœ¨å®¹å™¨å­—é¢é‡(@[@"1",@"2"])ä¸­æ’å…¥ç©ºæ ¼
SpaceBeforeAssignmentOperators: true #åœ¨=å·å‰åŠ ç©ºæ ¼

ContinuationIndentWidth: 4 
#åœ¨ç»­è¡Œ(\  
#     ä¸‹ä¸€è¡Œ)æ—¶çš„ç¼©è¿›é•¿åº¦
CommentPragmas:  '^ IWYU pragma:'
ForEachMacros:   [ foreach, Q_FOREACH, BOOST_FOREACH ]
SpaceBeforeParens: ControlStatements   #æ˜¯å¦åœ¨æ‹¬å·å‰åŠ ä¸Šç©ºæ ¼
DisableFormat:   false #ç¦ç”¨å½“å‰formatæ–‡ä»¶
```



## 7.å¯èƒ½å‡ºç°çš„é—®é¢˜

1.`.simple` æ–‡ä»¶åç¼€çš„ç§»é™¤

2.å¦‚æœè‡ªå·±æ–°å»ºçš„é’©å­æ–‡ä»¶ä¸ç”Ÿæ•ˆï¼Œæ‰§è¡Œä¸€é chmod +x æ–‡ä»¶å

3.ä½¿ç”¨ spacecommander å»è‡ªåŠ¨ç¼–è¯‘ä»£ç æ ¼å¼çš„æ—¶å€™ ä¸€å®šè¦ç”¨ä»–æç¤ºçš„ç»å¯¹åœ°å€çš„æ–‡ä»¶è·¯å¾„ 



## 8.åŸºäºClangçš„iOSä»£ç æ ¡éªŒå·¥å…·

å‰é¢é—ç•™ä¸‹æ¥çš„é‚£ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆæ›´å¥½çš„å»ä½¿ç”¨ spacecommander å»åšäº‹æƒ…ï¼Œå»ä¼˜åŒ–æˆ‘ä»¬çš„ä»£ç é£æ ¼ã€‚

ä»»åŠ¡:

1.æ›´å®Œå–„çš„ä»£ç æ ¡éªŒ

2.æ›´æ–¹ä¾¿çš„é›†æˆï¼Œæ›´ç®€æ˜“çš„éƒ¨ç½²åˆ°é¡¹ç›®ä¸­

3.æ›´åˆç†çš„ä»£ç æç¤ºå’Œ ä»£ç ä¸è§„èŒƒå¤„æç¤ºã€‚

4.ä»£ç é™æ€æ‰«æï¼ŒæœåŠ¡å™¨ç«¯è¿è¡Œè„šæœ¬è¿›è¡Œå…¨å±€æ‰«ææ ¡éªŒ



IOS ä»£ç æ ¡éªŒï¼Œä¸€é”®éƒ¨ç½²ï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¬¡å‘½ä»¤æ–‡ä»¶å°±å¯ä»¥ç»™IOSé¡¹ç›®éƒ¨ç½²ä»£ç æ ¡éªŒå·¥å…·

ä¾èµ–äºGit hooks æ¯æ¬¡ä»£ç  commit çš„æ—¶å€™è¿›è¡Œä»£ç å¼ºåˆ¶æ ¡éªŒã€‚

è¦æ±‚ï¼šGitå·¥ç¨‹ã€OCä»£ç 

å®ç°:

### 1.å‡å°‘ç”¨æˆ·ä½¿ç”¨æ—¶çš„æ­¥éª¤

å·¥å…·éƒ¨ç½²åªéœ€è¦ä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼Œè‡ªåŠ¨ä¸‹è½½æ ¡éªŒå·¥å…·ã€éƒ¨ç½²è„šæœ¬å’Œé’©å­ä»¥åŠåˆ›å»ºæ–°çš„æ“ä½œå‘½ä»¤

```
1.æå–é¡¹ç›®ä¸­å¾—setup.commandæ–‡ä»¶æ”¾ç½®åˆ°å·¥ç¨‹çš„æ ¹ç›®å½•ï¼ŒåŒå‡»æ‰§è¡Œ å¹¶æ ¹æ®æç¤ºæ“ä½œcommandæ–‡ä»¶

2.å¦‚æœæ‰§è¡Œæç¤ºæ— æƒé™ > ç»ˆç«¯ cd åˆ°å½“å‰ç›®å½• æ‰§è¡Œ chmod +x setup.command

3.Would you like to use the codeChecker ? [ yes / no ]

4.é€‰ä¸­ no ä¸ºå¸è½½æ“ä½œï¼Œå½“ä¸éœ€è¦ä»£ç æ ¡éªŒçš„æ—¶å€™æ‰§è¡Œæ­¤æ“ä½œ / é€‰æ‹©yesä¸ºå®‰è£…æ“ä½œã€‚

5.Which style do you need ?  [ list / window ]

6.æä¾›ä¸¤ç§æ¨¡å¼
```

### 2.æä¾›ä¸¤ç§ä»£ç æç¤º

ä¸ºæ–¹ä¾¿ä¸åŒçš„ä½¿ç”¨ï¼Œç°æä¾›ä¸¤ç§ä»£ç è§„èŒƒæç¤ºæ¨¡å¼ï¼šlist æ¨¡å¼ / window æ¨¡å¼

1.listæ¨¡å¼

listæ¨¡å¼æ¯æ¬¡commitä¼šè‡ªåŠ¨æ˜¾ç¤ºé”™è¯¯æ–‡æ¡£ï¼Œæ˜¾ç¤ºä»£ç çº æ­£ç‚¹ï¼Œå¯ä»¥æ ¹æ®ä»£ç é—®é¢˜ç‚¹è‡ªè¡Œè¿›è¡Œä»£ç ä¿®æ•´ æˆ–è€…ä½¿ç”¨å¿«æ·å‘½ä»¤è‡ªåŠ¨ä¿®æ”¹ä»£ç æ ¼å¼ã€‚

![](https://xilankong.github.io/resource/list.png)

å¦‚ä¸Šå›¾éƒ¨åˆ†ï¼Œâ€»å·ä¸‹é¢ä¸ºåŸæœ¬çš„é”™è¯¯æ ·å¼  â€” å·ä¸‹é¢éƒ¨åˆ†ä¸ºæ ¡éªŒåä»£ç æ ·å¼ æ•°å­—åˆ†åˆ«è¡¨ç¤ºä»å¤šå°‘è¡Œå¼€å§‹åˆ°å¤šå°‘è¡Œã€‚!å·è¡¨ç¤ºæœ‰å˜æ›´çš„è¡Œï¼Œ+å·è¡¨ç¤ºæ–°å¢ï¼Œ-å·è¡¨ç¤ºåˆ é™¤   :q é€€å‡ºæŸ¥çœ‹ï¼Œæ¯ä¸€ä»½ä»£ç æ–‡ä»¶éƒ½ä¼šå•ç‹¬å±•ç¤ºæ ·å¼ä¿®æ”¹ä¿¡æ¯ã€‚

![](https://xilankong.github.io/resource/list-tips.png)

åŒæ—¶ç»ˆç«¯ä¹Ÿä¼šæç¤ºä½ ç°åœ¨åœ¨æ ¡éªŒçš„æ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ–å•ä¸ªæ ¡éªŒã€å¤šä¸ªæ ¡éªŒçš„å‘½ä»¤ç­‰ ã€‚

2.windowæ¨¡å¼

windowæ¨¡å¼å¼€å¯ä»£ç å¯¹æ¯”åŠŸèƒ½ï¼Œå·¦ä¾§ä¸ºè‡ªå·±çš„ä»£ç ã€å³ä¾§ä¸ºè§„èŒƒä»£ç ï¼Œæä¾›å¿«æ·æ–¹å¼è¿›è¡Œä»£ç ä¿®æ­£è¦†ç›–ã€‚

![](https://xilankong.github.io/resource/window.png)

å¦‚ä¸Šå›¾éƒ¨åˆ†ï¼Œå·¦ä¾§ä¸ºæˆ‘ä»¬çš„ä»£ç ï¼Œå³ä¾§ä¸ºformatåçš„ä»£ç ï¼Œå…¶ä¸­æœ‰å˜æ›´çš„åœ°æ–¹éƒ½æœ‰é¢œè‰²æ ‡æ˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¿«æ·é”®æ¥å¿«é€Ÿçš„åœ¨éœ€è¦å˜æ›´çš„èŠ‚ç‚¹è·³è½¬å’ŒèŠ‚ç‚¹è¦†ç›–ã€‚ä»¥åŠä»£ç çš„è¿˜åŸå’Œæ’¤é”€ï¼Œå½“å¤„ç†å®Œæˆåé¢œè‰²å…‰æ ‡ä¼šæ¶ˆå¤±ï¼Œwqa ä¿å­˜é€€å‡ºå³å¯ã€‚ä¸‹é¢æ˜¯å¸¸ç”¨å¿«æ·æ–¹å¼

```
window æ¨¡å¼ä¸‹çš„æ“ä½œå¿«æ·æ–¹å¼

Ctrl - w åˆ‡æ¢å…‰æ ‡ä½ç½®

Ctrl-w Kï¼ˆæŠŠå½“å‰çª—å£ç§»åˆ°æœ€ä¸Šè¾¹ï¼‰

Ctrl-w Hï¼ˆæŠŠå½“å‰çª—å£ç§»åˆ°æœ€å·¦è¾¹ï¼‰

Ctrl-w Jï¼ˆæŠŠå½“å‰çª—å£ç§»åˆ°æœ€ä¸‹è¾¹ï¼‰

Ctrl-w Lï¼ˆæŠŠå½“å‰çª—å£ç§»åˆ°æœ€å³è¾¹ï¼‰

]c è·³å‘ä¸‹ä¸€ä¸ªç¼–è¾‘ç‚¹

[c è·³å‘ä¸Šä¸€ä¸ªç¼–è¾‘ç‚¹

do å°†å¦ä¸€ä¸ªæ–‡ä»¶çš„ç¼–è¾‘ç‚¹è¦†ç›–åˆ°å½“å‰æ–‡ä»¶ï¼ˆæ³¨æ„å…‰æ ‡ä½ç½®ï¼‰

dp å°†å½“å‰æ–‡ä»¶çš„ç¼–è¾‘ç‚¹è¦†ç›–åˆ°å¦ä¸€ä»½æ–‡ä»¶

Ctrl - u æ’¤é”€ä¿®æ”¹(ä¿è¯å…‰æ ‡åœ¨éœ€è¦æ’¤é”€çš„æ–‡ä»¶ä¸‹ å¤„äºINSERTæ¨¡å¼) å¦‚æœéINSERTæ¨¡å¼ç›´æ¥ u å°±æ˜¯æ’¤é”€

:qa ä¸ä¿®æ”¹é€€å‡º ï¼ˆç¼–è¾‘è¿‡åä¸å¯ç”¨ éœ€è¦ä½¿ç”¨ :qa! è¡¨ç¤ºæ’¤é”€ä¿®æ”¹åé€€å‡ºï¼‰

:wqa ä¿å­˜ä¿®æ”¹é€€å‡º
```

### 3.ä»£ç å®‰å…¨å¤‡ä»½ï¼Œä»£ç è¯¯æ“ä½œè¿˜åŸ

ç”±äºåœ¨åˆšå¼€å§‹ä½¿ç”¨ç»ˆç«¯æ“ä½œçš„æ—¶å€™ç»å¸¸ä¼šæœ‰è¯¯æ“ä½œçš„å¯èƒ½ï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢å½±å“åˆ°è‡ªå·±çš„å·¥ä½œä»£ç ï¼Œæ‰§è¡Œcommitçš„æ—¶å€™ï¼Œä¼šé»˜è®¤å¤‡ä»½åˆ°æŒ‡å®šç›®å½•ã€‚

å½“æƒ³æ¢å¤åˆšåˆšæ‰§è¡Œçš„formatæ“ä½œå¯ä»¥ä½¿ç”¨codelogå‘½ä»¤æŸ¥çœ‹formatè®°å½•ï¼Œcoderesetå‘½ä»¤(å‚æ•°æ˜¯éœ€è¦è¿˜åŸçš„æ–‡ä»¶åœ¨é¡¹ç›®ä¸­çš„ç›¸å¯¹åœ°å€)è¿˜åŸåˆšåˆšæ“ä½œè¿‡çš„æ–‡ä»¶ã€‚(æš‚æ—¶åªæ”¯æŒå•æ–‡ä»¶è¿˜åŸï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤‡ä»½æ•°æ®åœ¨æœ¬åœ°è¿›è¡Œè¿­ä»£ã€‚å¦‚æœéœ€è¦æŸä¸ªæ–‡ä»¶çš„å¤šä¸ªç‰ˆæœ¬å‰çš„å¤‡ä»½è®°å½•ï¼Œéœ€è¦å…ˆè¿˜åŸå¤‡ä»½ç›®å½•åˆ°æŒ‡å®šèŠ‚ç‚¹)ã€‚

codelog

![](https://xilankong.github.io/resource/codelog.png)

codereset

![](https://xilankong.github.io/resource/codereset.png)

æ¯æ¬¡çš„formatè¿‡ç¨‹éƒ½ä¼šå¤‡ä»½æ–‡ä»¶ï¼Œå¹¶ä¸”è¿™äº›æ–‡ä»¶ä»¥è¿­ä»£çš„æ–¹å¼ä¿å­˜ã€‚ç›®å½• Document/codeCheckerCache

### 4.é—®é¢˜

1.æ›´å®Œç¾çš„å¤‡ä»½æ¢å¤æœºåˆ¶

2.vimdiffæ˜¯å¦èƒ½æ›´å¤šè‡ªå®šä¹‰

3.æœåŠ¡å™¨ç«¯çš„é™æ€æ‰«æ

4.ä¸°å¯Œæ ¡éªŒè§„åˆ™



### 5.é“¾æ¥

 [setup.command](https://github.com/xilankong/IosCodeChecker)



## 9.å‚è€ƒã€æ —å­

[Git Hooks æ–‡æ¡£](https://git-scm.com/book/zh/v1/è‡ªå®šä¹‰-Git-GitæŒ‚é’©)

[spacecommander](https://github.com/square/spacecommander/)

[clang-format](http://clang.llvm.org/doxygen/structclang_1_1format_1_1FormatStyle.html)

[clang-format-demo](http://clangformat.com)

[IOS ä»£ç æ ¡éªŒå°è£…ï¼ˆä»…é™OCï¼‰](https://github.com/xilankong/IosCodeChecker)



