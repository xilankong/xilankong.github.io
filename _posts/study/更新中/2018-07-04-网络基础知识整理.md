---
layout: post
category: 学习之路
title : "网络基础知识整理"
---



## 网络通信三要素

```
通过 “IP” 找服务器，通过 “端口” 找进程， 通过 “协议” 确定如何传输数据


IP地址(主机名)

端口号

用于标示进程的逻辑地址，不同进程的标示
有效端口：0~65535
其中 0~1024由系统使用或者保留端口
开发中不要使用 1024 以下的端口
注意 : 跟HTTP相关的端口一定是80.服务器上有个进程是专门处理HTTP请求的,端口号是80.

传输协议

TCP(传输控制协议) 
相当于打电话,必须先建立好链接才能传输数据. 
HTTP协议底层是基于TCP/IP协议的.
UDP(数据报文协议) 
相当于发电报,不用关心对方是否能够收到.不太安全.

HTTP网络传输协议在传输层选择的是TCP/IP协议
```



### UDP（User Datagram Protocol:用户数据报协议）

- 只管发送，不确认对方是否接收到
- 将数据源和目的封装成数据包中，不需要建立连接,是不可靠协议
- 每个数据报的大小限制在64K之内，速度快
- 应用场景：多媒体教室／网络流媒体 / 视频实时共享

### TCP（Transmission Control Protocol:传输控制协议）

- 建立连接，形成传输数据的通道
- 在连接中进行大数据传输（数据大小不受限制）
- 通过三次握手完成连接，四次分手结束连接,是可靠协议，安全送达
- 必须建立连接，效率会稍低,TCP协议的传输速度比UDP协议慢
- 提供超时重发，丢弃重复数据，检验数据，流量控制等功能



### TCP三次握手建立连接

- 要想明白Socket连接，先要明白TCP连接。手机能够使用联网功能是因为手机底层实现了TCP/IP协议，可以使手机终端通过无线网络建立TCP连接。
- 当应用层向TCP层发送用于网间传输的、用8位字节表示的数据流，TCP则把数据流分割成适当长度的报文段，最大传输段大小（MSS）通常受该计算机连接的网络的数据链路层的最大传送单元（MTU）限制。之后TCP把数据包传给IP层，由它来通过网络将包传送给接收端实体的TCP层。
- TCP为了保证报文传输的可靠，就给每个包一个序号，同时序号也保证了传送到接收端实体的包的按序接收。然后接收端实体对已成功收到的字节发回一个相应的确认(ACK)；如果发送端实体在合理的往返时延(RTT)内未收到确认，那么对应的数据（假设丢失了）将会被重传。
- ACK表示Acknowledgment Number字段有意义 
  PSH表示Push功能，RST表示复位TCP连接 
  SYN表示SYN报文（在建立TCP连接的时候使用,发起一个新连接） 
  FIN表示没有数据需要发送了（在关闭TCP连接的时候使用）

TCP是主机对主机层的传输控制协议，提供可靠的连接服务，采用三次握手确认建立一个连接:

位码即tcp标志位,有6种标示:

SYN(synchronous建立联机)

ACK(acknowledgement 确认)

PSH(push传送)

FIN(finish结束)

RST(reset重置)

URG(urgent紧急)

Sequence number(顺序号码)

Acknowledge number(确认号码)



各个状态的意义如下：

  
LISTEN - 侦听来自远方TCP端口的连接请求；  
SYN-SENT -在发送连接请求后等待匹配的连接请求；  
SYN-RECEIVED - 在收到和发送一个连接请求后等待对连接请求的确认；  
ESTABLISHED- 代表一个打开的连接，数据可以传送给用户；  
FIN-WAIT-1 - 等待远程TCP的连接中断请求，或先前的连接中断请求的确认； 
FIN-WAIT-2 - 从远程TCP等待连接中断请求；  
CLOSE-WAIT - 等待从本地用户发来的连接中断请求；  
CLOSING -等待远程TCP对连接中断的确认；  
LAST-ACK - 等待原来发向远程TCP的连接中断请求的确认；  
TIME-WAIT -等待足够的时间以确保远程TCP接收到连接中断请求的确认；  
CLOSED - 没有任何连接状态；



**客户端TCP状态迁移：**
CLOSED->SYN_SENT->ESTABLISHED->FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED
服务器TCP状态迁移：
CLOSED->LISTEN->SYN收到->ESTABLISHED->CLOSE_WAIT->LAST_ACK->CLOSED

![png](https://xilankong.github.io/resource/tcp.png)























RTMP