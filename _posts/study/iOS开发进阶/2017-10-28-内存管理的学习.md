---
layout: post
category: iOS开发进阶
title : "内存管理的学习"
---





参考

[理解iOS的内存管理](http://blog.devtang.com/2016/07/30/ios-memory-management/)

整理引用计数等问题，释放池工作原理等

内存如何优化等



2、objective-c  runtime运行机制和内存管理机制



3、swift带来的影响、混编影响



4、ios底层实现机制



autoreleasePool实现原理

https://www.jianshu.com/p/0d32ba68fe72





### 关于内存五大分区

- **BSS段:**
  - BSS段( *bss segment* )通常是指用来存放程序中`未初始化的全局变量和静态变量` 的一块内存区域。
  - 这里注意一个问题:一般的书上都会说全局变量和静态变量是会自动初始化的,那么哪来的未初始化的变量呢?变量的初始化可以分为显示初始化和隐式初始化,全局变量和静态变量如果程序员自己不初始化的话的确也会被初始化,那就是不管什么类型都初始化为0,这种没有显示初始化的就 是我们这里所说的未初始化。`既然都是0那么就没必要把每个0都存储起来,从而节省磁盘空间,这是BSS的主要作用`
  - BSS是英文Block Started by Symbol的简称。BSS段属于静态内存分配。 BSS节不包含任何数据,只是简单的维护开始和结束的地址,即总大小。以便内存区能在运行时分配并被有效地清零。BSS节在应用程序的二进制映象文件中并不存在,即不占用 磁盘空间 而只在运行的时候占用内存空间 ,`所以如果全局变量和静态变量未初始化那么其可执行文件要小很多`。
- **数据段(data segment)**
  - 通常是指用来存放程序中已经`初始化的全局变量和静态变量`的一块内存区域。数据段属于静态内存分配,可以分为`只读数据段`和`读写数据段`。字符串常量等,但一般都是放在只读数据段中。
- **代码段(code segment/text segment)**
  - 通常是指用来存放`程序执行代码的一块内存区域`。这部分区域的大小在程序运行前就已经确定,并且内存区域通常属于只读, 某些架构也允许代码段为可写,即允许修改程序。在代码段中,也有可能包含一些只读的常数变量,例如字符串常量等,但一般都是放在只读数据段中 。
- **堆(heap)**
  - 堆是用于存放进程运行中被`动态分配的内存段`,它的大小并不固定,可动态扩张或 缩减。当进程调用malloc等函数分配内存时,新分配的内存就被动态添加到堆上(堆被扩张); 当利用free等函数释放内存时,被释放的内存从堆中被剔除(堆被缩减)
- **栈 (stack heap)**
  - 栈又称堆栈, 是`用户存放程序临时创建的局部变量`,也就是说我们函数括弧“{}” 中定义的变量(但不包括static声明的变量,static意味着在`数据段`中存放变量)。除此以外, 在函数被调用时,其参数也会被压入发起调用的进程栈中,并且待到调用结束后,函数的返回值 也会被存放回栈中。由于栈的后进先出特点,所以 栈特别方便用来保存/恢复调用现场。从这个意义上讲,我们可以把堆栈看成一个寄存、交换临时数据的内存区。