---
layout: post
category: 2018年
title : "iOS逆向与安全"
---

http://blog.jobbole.com/author/yiyaaixuexi/



iOS应用安全机制

keychain

http://www.jianshu.com/p/3afc39f6b9a8

http://blog.csdn.net/ibcker/article/details/24839143

http://www.cocoachina.com/ios/20161129/18215.html



在开启 keychain的时候，生成的entitlements默认生成了一个item，填写的是当前app的bundleID，但其实应该是TeamID，前面还有前缀：AppIdentifierPrefix

例如： 98XXXXXXAXTT.com.yang.OCDemoTwo

默认写入的keychain在entitlements的第一项，加入有一部分内容你不希望分享给兄弟app，那么就可以单独设立一个share的group专门用于分享内容

entitlements 中写入的item只要共享数据的app填写相同即可，不需要特殊，

如果在默认情况下，app默认是存在当前teamID这个名字的group下面，所以如果两个App希望全部共享对方的keychain内容，则只需要把两个app的teamID 都填入keychain groups即可。

正常情况下我们会开启独立分享组：

第一项item为自己的teamID，第二项为我们需要共享的keychain组组名

当我们需要分享时，把内容指定存入分享组内，不需要分享时默认存放即可





keychain 维持唯一UUID





keychain 存放在哪？



codesign



```
 [self haveBundleIdentifier];//获取BundleIdentifier
    [self haveappidentifierprefix];//获取appidentifierprefix
   [self haveBundleExecutable];//获取项目名称
- (void)haveBundleExecutable{


- (void)haveappidentifierprefix{
    NSString * prefix = [self bundleSeedID];
    NSLog(@"prefix-->%@",prefix);
    
}

- (NSString *)bundleSeedID {
    NSDictionary *query = [NSDictionary dictionaryWithObjectsAndKeys:
                           kSecClassGenericPassword, kSecClass,
                           @"bundleSeedID", kSecAttrAccount,
                           @"", kSecAttrService,
                           (id)kCFBooleanTrue, kSecReturnAttributes,
                           nil];
    CFDictionaryRef result = nil;
    OSStatus status = SecItemCopyMatching((CFDictionaryRef)query, (CFTypeRef *)&result);
    if (status == errSecItemNotFound)
        status = SecItemAdd((CFDictionaryRef)query, (CFTypeRef *)&result);
    if (status != errSecSuccess)
        return nil;
    NSString *accessGroup = [(__bridge NSDictionary *)result objectForKey:kSecAttrAccessGroup];
    NSArray *components = [accessGroup componentsSeparatedByString:@"."];
    NSString *bundleSeedID = [[components objectEnumerator] nextObject];
    CFRelease(result);
    return bundleSeedID;
}


- (void)haveBundleIdentifier{
    NSString * identifier = [[NSBundle mainBundle]bundleIdentifier];
    NSLog(@"identifier--->%@",identifier);
}

- (void)haveBundleExecutable{

    NSString *executableFile = [[[NSBundle mainBundle] infoDictionary] objectForKey:(NSString *)kCFBundleExecutableKey];    //获取项目名称
    NSLog(@"executableFile-->%@",executableFile);
    
    NSString *version = [[[NSBundle mainBundle] infoDictionary] objectForKey:(NSString *)kCFBundleVersionKey];      //获取项目版本号
    
    
    
    NSDictionary *infoDictionary = [[NSBundle mainBundle] infoDictionary];
    NSLog(@"infoDictionary-->%@",infoDictionary);
    // app名称
    NSString *app_Name = [infoDictionary objectForKey:@"CFBundleDisplayName"];
    // app版本
    NSString *app_Version = [infoDictionary objectForKey:@"CFBundleShortVersionString"];
    // app build版本
    NSString *app_build = [infoDictionary objectForKey:@"CFBundleVersion"];
}
```







https://www.apple.com/business/docs/iOS_Security_Guide.pdf

http://blog.csdn.net/ibcker/article/details/24839143