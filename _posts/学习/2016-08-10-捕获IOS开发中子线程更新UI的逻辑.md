---
layout: post
category: 学习之路
---

1.为什么UI要在主线程更新

因为UIKit不是线程安全的。试想下面这几种情况：
两个线程同时设置同一个背景图片，那么很有可能因为当前图片被释放了两次而导致应用崩溃。 
两个线程同时设置同一个UIView的背景颜色，那么很有可能渲染显示的是颜色A，而此时在UIView逻辑树上的背景颜色属性为B。 
两个线程同时操作view的树形结构：在线程A中for循环遍历并操作当前View的所有subView，然后此时线程B中将某个subView直接删除，这就导致了错乱还可能导致应用崩溃。 
iOS4之后苹果将大部分绘图的方法和诸如 UIColor 和 UIFont 这样的类改写为了线程安全可用，但是仍然强烈建议讲UI操作保证在主线程中执行。

2.有什么软件或者插件可以测试这个问题吗？



3.我的想法，UIView的更新操作 使用runtime 去替换 UIView 的方法在中间插入 线程检查，发现子线程就crash并指出对应View